<!DOCTYPE HTML>


<html>
<head>
	<title>Semantic Database: Concept, Architecture and Implementation - CodeProject</title> 
	<link type="text/css" rel="stylesheet" href="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.170803.1">

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="No word has a value that can be identified independently of what else is in its vicinity.; Author: Marc Clifton; Updated: 25 Oct 2014; Section: Algorithms &amp; Recipes; Chapter: General Programming; Updated: 25 Oct 2014">
<meta name="Keywords" content="C#, .NET, database, Web, SQLite, PostgreSQL, RDF, NoSQL, OWL, Graph,Algorithms &amp; Recipes,General Programming,Free source code, tutorials">
<meta name="Author" content="Marc Clifton">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="//ajax.googleapis.com"> 



<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx" />
<meta name="robots" content="index, follow" />
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "headline": "Semantic Database: Concept, Architecture and Implementation",
  "url": "https://www.codeproject.com/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme",
  "discussionUrl": "https://www.codeproject.com/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/recipes/832959/Thumb-832959.png",
  "keywords": "C#, .NET, SQLite, PostgreSQL, OWL, database, Web, RDF, NoSQL, Graph",
  "commentCount": "16",
  "editor" : {
    "@type" : "Person",
    "name" : "Marc Clifton",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=36803"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  }
  "description": "No word has a value that can be identified independently of what else is in its vicinity.",
  "upvoteCount": "35",
  "articleSection": "Algorithms & Recipes",
  "author" : [{
      "@type" : "Person",
      "name" : "Marc Clifton",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=36803"
    }],
  "datePublished": "2014-10-25",
  "dateCreated": "2014-10-25",
  "dateModified": "2014-10-25",
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.99,
    "ratingCount" : 35,
    "bestRating" : 5,
    "worstRating" : 1
  },
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/6/General-Programming.aspx",
      "name" : "General Programming"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/recipes/",
      "name" : "Algorithms & Recipes"
    }
  }]
}
</script>
	<base target="_top" />
	<link rel="icon" href="https://www.codeproject.com/favicon.ico" type="image/ico" >
<link rel="shortcut icon" href="https://www.codeproject.com/favicon.ico"  type="image/ico" >
<link rel="apple-touch-icon" href="https://www.codeproject.com/favicon.ico" type="image/png" >
<script type="text/javascript" language="Javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script><script type='text/javascript'>//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='%2fscript%2fJS%2fjquery-2.2.4.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
function defrm () { /* thanks twitter */ document.write = ''; window.top.location = window.self.location;  setTimeout(function() { document.body.innerHTML = ''; }, 0);  window.self.onload = function(evt) { document.body.innerHTML = ''; }; }if (window.top !== window.self) {  try {  if (window.top.location.host) { /* will throw */ } else { defrm(); /* chrome */ }  } catch (ex) { defrm(); /* everyone else */ } }if (typeof(DemoUrl)!='undefined')   document.write(unescape('%3Cme')+'ta http'+'-equiv="re'+'fresh"                  con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));

//]]>
</script>

	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script>


</head>	

<body class="chrome chrome59">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://codeproject.global.ssl.fastly.net/images/t.gif" /></a>





<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix">

	<div id="ctl00_MemberMenu_GenInfo" class="float-left">13,073,544 members (62,518 online)</div>

	<div class="float-left">
		
	</div>

	<div class="float-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme"
				else
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme"
				document.subForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme">Sign in</a></span>

				<div class="tooltip-flyout">
					<form name="subForm" id="subForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme" method="post" 
						class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden" />

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email" /></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password" /></div>
						<div class="action">
							
                                  <input id='joinBtn' type='button' class='create hidden' onclick='return Join();' value='Join' />
                                  <input type='hidden' name='fld_quicksign' value='true' />
                                  <script type="text/javascript">
                                  function simpleMask(str, key) {
                                      var result = ''; 
                                      for (var i = 0; i < str.length; ++i)
                                          result += String.fromCharCode(key ^ str.charCodeAt(i));
                                      return result;
                                  }
                                  function Join() {
                                      var url = 'https://www.codeproject.com/script/Membership/Modify.aspx';
document.location.href=url;
                                      return false;
                                  }
                                  $('#joinBtn').css('visibility', 'visible');
                                  </script>
							<input type="submit" value="Sign in" class="signin" 
								onclick="return doSubmit(false);" />
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberMenu_SendPassword" class="forgot float-right" href="/script/Membership/SendPassword.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark" />

					Sign in with <a class="oauth" title="Sign in using Github" href="/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="/script/Membership/Images/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" title="Sign in using Linkedin" href="/script/Membership/OAuthLogOn.aspx?auth=LinkedIn"><img src="/script/Membership/Images/linkedin.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" title="Sign in using Microsoft" href="/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="/script/Membership/Images/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;" /></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Data-Structures"  data-tags='C#, .NET, database, Web, SQLite, PostgreSQL, RDF, NoSQL, OWL, Graph,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=728x90&c=950477"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=728x90&c=950477"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	<a href="#Main"><img alt="Click here to Skip to main content" class="access-link" 
        src="https://codeproject.global.ssl.fastly.net/images/t.gif" /></a>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tr><td><input TabIndex="2" class="search " id="sb_tb" value="" name="q" /></td><td><input type="image" src="https://codeproject.global.ssl.fastly.net/images/search.gif" /></td></tr></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br /></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="true"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com">home</a>


<li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout">
			<li>
				<div id="siteMap">
					<img src="https://codeproject.global.ssl.fastly.net/images/loading48.gif" alt="loading" style="margin:150px;width:100px;height:100px;" />
				</div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="/search.aspx?sbo=kw">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="/search.aspx?sbo=kw?aidlst=152&amp;sa_us=True">Beginner Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly break" href="/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article Competition</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx">
			<img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px" /> Submit an article or tip
			</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx">
			<img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px" /> Post your Blog
			</a></li>		<li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px" /> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img 
			src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px" /> Ask a Question</a></li>

		
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions...</a></li>
		
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">Javascript questions</a></li>
			
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable desktop-only"><a id="ctl00_TopNavBar_Features" href="/Feature/">features</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Awards/CurrentCompetitions.aspx?cmpTpId=1&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="/KB/showcase/">Product Showcase</a></li>
		<li><a id="ctl00_TopNavBar_Research" class="fly" href="/script/ResearchLibrary/Index.aspx">Research Library</a></li>

		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li  class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="/script/Awards/MVPWinners.aspx">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="/Lounge.aspx">The Lounge  </a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird & The Wonderful</a></li>
		<li><a id="ctl00_TopNavBar_SoapBoxLnk" class="fly" href="/Forums/1536756/The-Soapbox.aspx">The Soapbox</a></li>
		<li><a id="ctl00_TopNavBar_PRLnk" class="fly break" href="/Forums/1738007/Press-Releases.aspx">Press Releases</a></li>

		
		<li class="openable"><a class="fly" href="/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		<li><a class="fly" href="/Forums/1580230/Chinese.aspx">General Chinese Topics</a></li>
		</ul>
		<li class="last"></li>
		
	</ul>

</li>


<li class="openable desktop-only tablet-only" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">help</a>

	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="/script/Content/SiteMap.aspx">Site Map</a></li>
		<li><a id="ctl00_TopNavBar_HelpAdvertise" class="fly" href="http://developermedia.com/">Advertise with us</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutAds" class="fly" href="/info/AboutOurAds.aspx">About our Advertising</a></li>
		<li><a id="ctl00_TopNavBar_HelpJobs" class="fly" href="/info/Jobs/">Employment Opportunities</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 
	<div class="container-content">


		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="/script/Content/SiteMap.aspx">Articles</a> &#187; <a href="/Chapters/6/General-Programming.aspx">General Programming</a> &#187; <a href="/KB/recipes/">Algorithms & Recipes</a> &#187; <a href="/KB/recipes/#Data+Structures">Data Structures</a></div>
			</div>

            

			<div class="edit-links float-right">
				


 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				

<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



<a id="ctl00_ActionLinks_BookmarkMd_ImgBt" title="Bookmark" AlternateText="Bookmark" name="bm_832959_2" onclick="return bookmarkMe(832959,2,&#39;/script/Bookmarks/Ajax/Add.aspx?obid=832959&amp;obtid=2&amp;bio=true&amp;bis=medium&#39;,&#39;medium&#39;);" href="/script/Bookmarks/Add.aspx?obid=832959&amp;obtid=2&amp;bio=true&amp;bis=medium" style="display:inline-block;height:24px;width:24px;"><img title="Bookmark" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/bookmark24.png" alt="" style="border-width:0px;" /></a>


<span id="ctl00_ActionLinks_BookmarkMd_StatusMsg" class="tiny-text" style="display:none" name="bm_832959_2"></span>
<a id="ctl00_ActionLinks_PrintMd" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?display=Print">
	    <img src="https://codeproject.global.ssl.fastly.net/images/print24.png" title="Print"
		    width="24px" height="24px" style="border:0">
    </a>
			</div>
		</div>

		<table class="extended container-article-parts" cellpadding="0" cellspacing="0">
        <tr valign="top">
		<td width="117px" class="article-wing-left">

			<div id="ctl00_Nav" class="container-article-tabs">
    			

<div class="tabs">
	<div class="selected">Article</div><div class="unselected"><a href="/script/Articles/ViewDownloads.aspx?aid=832959">Browse Code</a></div><div class="unselected"><a href="/script/Articles/Statistics.aspx?aid=832959">Stats</a></div><div class="unselected"><a href="/script/Articles/ListVersions.aspx?aid=832959">Revisions (2)</a></div><div class="unselected"><a href="/script/Articles/ListAlternatives.aspx?aid=832959">Alternatives</a></div>

	<div class="unselected"><a href="WebControls/#_comments" id="ctl00_ArticleTabs_CommentLink" class="anchorLink">Comments 
        <span id="ctl00_ArticleTabs_CmtCnt">(16)</span></a>
	</div>
</div>	


				<a id="ctl00_AddAlternative" title="Write a related article about upgrades or translate this into a different language." class="add-item" href="/script/Articles/SubmissionWizard.aspx?at=1&amp;apid=832959">Add your own<br />alternative version</a>

			    <div>
                    <h4>Tagged as</h4>
			        <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="/Tags/C--hash--" data-id="81">C#</a></div><div class="t"><a rel="tag" href="/Tags/.NET" data-id="98">.NET</a></div><div class="t"><a rel="tag" href="/Tags/database" data-id="782">database</a></div><div class="t"><a rel="tag" href="/Tags/Web" data-id="1147">Web</a></div><div class="t"><a rel="tag" href="/Tags/SQLite" data-id="1198">SQLite</a></div><div class="t"><a rel="tag" href="/Tags/PostgreSQL" data-id="1323">PostgreSQL</a></div><div class="t"><a rel="tag" href="/Tags/RDF" data-id="1516">RDF</a></div><div class="t"><a rel="tag" href="/Tags/NoSQL" data-id="2691">NoSQL</a></div><div class="t"><a rel="tag" href="/Tags/OWL" data-id="3560">OWL</a></div><div class="t"><a rel="tag" href="/Tags/Graph" data-id="3561">Graph</a></div></span> 

	
	
</span>


			    </div>

                <div class="stats">
                <h4>Stats</h4>
                <div id="ctl00_ArtStats"><div class="stats"><div>33.5K views</div><div>38 bookmarked</div></div></div>
                </div>

                <div class="subdue padded-top" title="Date First posted">Posted 
                    25 Oct 2014</div>

                <div title="Licence">
                    <a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                </div>

                
			</div>

		</td>
		<td>
			
			<div id="AT" class="container-article  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="okN1BoR7kz0onEVBUCQvK75i95k0+aDXsHQ0ck3R1DW1zZq3Ul0bvm8ghdnWMpkTbVwfYooiSgQGa96WZYhMiwTndDb8ENt/K+2FdRHeDBV/tswsfr8ZhlMJrhPoKRvDQi/AnPGTc29jzQ7bjn/bpRq/t6ed1mg62uScSul5c1XOV4DsxCR7BC+R4BvRJmZR4VNr7hMcaydN8DI5GZ6l+t2LaG77vMrUHGyOu7Y0sdSKjwfCWKuDWk/0Hyo+1dh/aK1DQr2RbEUW0717VAr4o1qSGgCSFlkSTBeMeXuDZ8RCl2dxqYYl3Oj2lebHDtdpQtamftw7vDhUAEzWQ0aXRtaZZgmOPvFwY06ijLSC9bQtTFASvlI+ZAd3s50NNyjESspPRgLk+pZCCJ8sWYOJlJ1sFzjpo1/U5XY2IMDC/acIzjppBQz8sdnXh/n+W2DbX0mHLQo33DF8q+hd27DE5dzh/SAydQcaFSSw+AatxDPMK+KAqaG2MrF2CrxF+UEgl+/cWx3Xdl+C/9wkx62dEnGyIeyjpZqNYYXUkTYPTy1FUHToHvox/+Fre6z6Y/cWyL/aQqoy/3QC/pvps/8WfgedshX+60Nblyd3n9EifDISZ1YgSfBh2C1NITo04CMCku1PGwm0RAJhwAM2owRMQYX1l3I0kcXVKqi+bELBPXl0weVl589uEiFnt+iZlIkHi2TPi0aqPXkdIr7RAABApuZjYk+VWQGN6NmPESX6rucD4LYTRAPrm014zUWWXeeO4a6FcTfjhExuubMAnuKAEJqQqVdviT21oExQohFUSMX0Fby0BQZ+75Zq+g50VcwK4sv1Bwk2ewDRXwEQ4pjzENVzbWlgof453eClJLSOfcjSiZd2q6k3TjcZV4sn1M0EnJycVqGjAboziTWLdQcoe9HwawH20MivQgnqcb4uxnY5R42uWD/XpWSunwWQ4eCMRD6W/Hdl90irGKDvXqkiqt4I0KbQ1LiTo8ij9YUstbBbCA7zyOAVCytEWc3itpooIrMQApI6w41DlcKye1luUrKQawMFqjKgYSjMnl+ZXvPvrHdITFMROSSuKrDc3J0/vOkEbndx2iV66x1rzzEbONOx+HBqQ2LHdc/V4YJ4Jx/EvrbLuYYgZDftcgdHqpIcqz8ck0gNzBVWxFkW6oe1szU3fwr3lU8/HEtwPDUanytwbQOy3MlXAJWi2RyKnPfB9+wAvohVb1iWGT7cOARjl5Q31mvZOCXR3OL7/rxQCFKTJpJg4DQQ3DVeo5vO2wEL+dFHoNXVbpG5pRqfm3CvxcPSyYDtwUKTC7rcuX3xyxc7KRk6Qy9++CtANcg9CDu2dYiq34S4seRsm/p1NNtSCLiBRpMKkL8HWtNsPizNqtFAblfGDHTadScALLONGPwmucILmU53JN4honQSi1DG0U6MOZTbCIhPYOPTv3hIMvVfjxuHWmOMME9HHvatAeHkZL1t0NXON6FHI7RmDCJ1F5OmJ8a7PUzGs/0guIhKxH57h6gooTopsNSZSttSC32kOWYMEcD3A5Zjnsul3ZCuoS4JtN8sLJMTGASoincyxP0mS8BLDqhUg9yxzFAHmlNwAhj0SkWvV4KRM4NkmfJoUk5OwwZe5Js8cujnrwdc+YnGIrCV+1DPhbt78AFLaG6wZGMqM8XyHhnCliy9D5ZiXR6zOC7sIA+yDVuSiW9LZY04hD72O35Mmb+GvUVqjDgE73mPZRjk92iMATdbpx88p39ghAjkgYimYOkIehh4+VLo6/q8EPhRSez+4U8apI1Eh3s8PD3NcNaY+LzMSweyUWtv3fGc3hOScZUCTeB94iO7yee9vgQw8Yt4onP8CnglmDFTNLbvK61IaVk1xEXQaAddNT7+t9fQ9iMMj5RyhvxLO7IztinDZIX0+M9GkjVd9H4HkevqGqy/kMMwajHl6xKU56zRLw7uY7vegr+PuVqjFAlrngryuvSW30S8VwpEdW+ZBTCDQhya6DJlhrJ/oSclB+GQKoqaRyFU661rNsfIRanAoBSiEeIIN1OaXVL2ht6bCgujvvu99syTtA/W/9bOJ3koTTv15Mb7YksmQbZq14+STwijXWCn7kDJuUf4HGqQzFgyUoWJbvNhTm6RQ23SpODHOFuz4sMLvyM80Rf1Fyspk3r/3Qr8GFff1geA2GnbDnH0V/zbZSBeJTpGcP+iEfZ+u40Jd2sqWa/qapbErB/qylNLPaKZJ9fK3YqFuCyUXiv60hH1XxwMb3pLlBNwndkpppbTJidzBAXBB7GnrMPwb7Tb/8MdgCjwQDUgf93T7YPJzOeKkfrNd37tlD5nUy0=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" />
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Semantic Database: Concept, Architecture and Implementation</h1>
					    </div>

                        <div style="height:34px">
					        
					        <div class="entry float-left">

                                <img src="https://www.codeproject.com/script/Membership/ProfileImages/{CCCA6270-7875-4937-96C2-0CF123E2F30F}.jpg" id="ctl00_avatar" class="float-left avatar" />

                                <div class="float-left">
                                    <div>
						                <span class="author"><a href="/script/Membership/View.aspx?mid=36803" rel="author">Marc Clifton</a></span>, 
						                <span class="date" title="Date last updated">
							            25 Oct 2014</span>
			                        </div>

                                    
						            <div id="ctl00_RateArticleRow" class="float-left align-right" style="margin-top:5px">

					                    <div id="ctl00_CurRat" class="tooltip anchorLink column" style="cursor:pointer;margin:2px 20px 0 0" name="CurRat_832959">
				
							                

<table id="ctl00_ArticleRating_RatingTable" cellpadding="0" cellspacing="0" class="small-text">
	<tr>
		<td class="nowrap">

		<span id="ctl00_ArticleRating_VI">
		<div class="nowrap rating-stars-medium" style="height:18px;width:80px;position:relative;">
			<div class="clipped align-left float-left" style="height:16px;width:79px;">
				<img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-fill-md.png" style="border-width:0px;" />
			</div><div class="clipped" style="height:16px;width:1px;position:relative;">
				<img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-empty-md.png" style="border-width:0px;position:absolute;top:0;right:0;" />
			</div>
		</div>
		</span>

		
	</td>
		<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;
		<span id="ctl00_ArticleRating_VotesR">&nbsp;4.99 (35 votes)</span>
		
	</td>
	</tr>
</table>

<span id="ctl00_ArticleRating_RatingText"></span>


							                <div id="ctl00_RB" class="speech-bubble-container-up">
								                <div class="speech-bubble-up" style="width:150px !important">
									                            
<div>
<table class="feature" width="100%" height="50px" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0"><tr class="chart-row"><td class="chart-column"><span title="0 votes">1</span></td>
<td class="chart-column"><span title="0 votes">2</span></td>
<td class="chart-column"><span title="0 votes">3</span></td>
<td class="chart-column"><div><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="1px" border="0px" alt="1 vote, 2.9%" title="1 vote, 2.9%" /></div><span title="1 vote">4</span></td>
<td class="chart-column"><div><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="50px" border="0px" alt="34 votes, 97.1%" title="34 votes, 97.1%" /></div><span title="34 votes">5</span></td>
</tr></table><div class="small-text align-center">4.99/5 - 35 votes</div><div class="small-text align-center subdue">μ 4.99, σ<sub>a</sub> 1.09 [<a href="/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]</div>
</div>
								                </div>
								                <div class="speech-bubble-pointer-up">
									                <div class="speech-bubble-pointer-up-inner"></div>
								                </div>
							                </div>

						                </div>
                                        <div class="column">
                                        <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_832959">

	<table width="100%" cellpadding="0" cellspacing="0" class="small-text">
	<tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" width="16px" alt="loading..." height="16px" 
				src="/images/loading16.gif" /> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tr>
				<td id="ctl00_RateArticle_RateText" class="rating-prompt">
					Rate this:
				</td>

				
				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap rating-stars-voter-medium">
					

					<span id="ctl00_RateArticle_RB" class="tooltip ajaxHist radio voting">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" /><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" /><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" /><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" /><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" /></span> 

						
					</span>

				</td>

				
				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" />
				</td>
			</tr>
			</table>
			
		</td>
	</tr>
	</table>
	<div class="hover-container">
		
        <div id="ctl00_RateArticle_RSU" class="rating-comment align-left float-right">
            <div class="padded">
            Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme">Sign up or sign in</a> to vote.
            </div>
        </div>
	</div>
</div>
                                        </div>
                                    
                                    </div>
    						        	

                                </div>

    	                        	
                                <div class="float-left" style="margin: 25px 0 0 10px;">
	                                
	                            </div>
                         	    	
    
					        </div>

                            

						    <div class="float-right align-center">
                                <div class="msg-210x60" data-format="210x60" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Data-Structures"  data-tags='C#, .NET, database, Web, SQLite, PostgreSQL, RDF, NoSQL, OWL, Graph,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=210x60&c=950477"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=210x60&c=950477"  width="210px" height="60px" target="_blank"/></a></noscript></div>
						    </div>

                        </div>

                        <div id="ctl00_description" class="summary">No word has a value that can be identified independently of what else is in its vicinity.</div><span id="ctl00_thumbnailUrl" class="date" content="https://www.codeproject.com/KB/recipes/832959/Thumb-832959.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<p align="center">Semantic Database</p>

<p align="center">Concept<br>
Architecture<br>
Implementation<br>
&nbsp;</p>

<p align="center"><img border="0" height="354" src="/KB/recipes/832959/struct2.png" width="687"></p>

<h2>Introduction</h2>

<p>This article discusses the concept of a semantic database in several sections:</p>

<ul>
	<li>Discussion of the concept and need for a semantic database</li>
	<li>Architectural Implications</li>
	<li>Implementation on top of an RDBMS</li>
	<li>Unit tests to vet basic insert and query operations (we'll leave update and delete for later)</li>
</ul>

<p>Part II will demonstrate the semantic database in action in the <a href="http://www.higherorderprogramming.com/developers-1-1-2/">Higher Order Programming Environment</a> with a useful application.&nbsp; If you are unfamiliar with HOPE, <a href="http://www.higherorderprogramming.com/developers-1-1-2/">this page</a> will refer you to the other articles here on Code Project.&nbsp; Because I'm writing the semantic database as a <i>persistence component</i>, you'll notice that the unit tests are interacting with "carriers", which is the vehicle for sending messages between "receptors" -- the stand-alone components.&nbsp; Also, because I'm talking about a semantic database, I'm leveraging the classes in HOPE that manage semantic structures, including the dynamic runtime compilation and instantiation of semantic structure instances.&nbsp; So there's a lot of prior work being used here as the scaffolding, but I doubt this will get in the way of understanding the concepts and the code.</p>

<p>As many of my readers will be used to by now, this is definitely going to be a walk on the wild side.&nbsp; The concepts, architecture, and implementation will hopefully challenge your preconceptions of what data is, and by corollary, what a semantic database is.</p>

<p>The reader will hopefully also forgive the rather deep foray into a non-technical discussion regarding semantics, as it is important to convey the necessary foundational information.</p>

<p>Lastly, even if you're not specifically interested in semantic database architectures, the code for generating the SQL query statements is useful in any application where you want to automate the joining of multiple tables based on schema information rather than hand-coding the complex joins or relying on an ORM.</p>

<h3>Where's the Code?</h3>

<p>As usual, the code can be cloned or forked from <a href="https://github.com/cliftonm/HOPE">GitHub</a>.&nbsp; In Part II, I'll have a branch specific to the code that goes along with that article.</p>

<h2>What is a Semantics?</h2>

<p>Semantics is an emerging field of research and development in information science, however, the concept has been around for a lot longer than computers!&nbsp; To begin with, semantics is the branch of linguistics and logic concerned with meaning.&nbsp; This can be broken down into three major categories:</p>

<ul>
	<li>Formal Semantics
	<ul>
		<li>Logical aspects of meaning:
		<ul>
			<li>Sense</li>
			<li>Reference</li>
			<li>Implication</li>
			<li>Logical form</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Lexical Semantics
	<ul>
		<li>Word meaning</li>
		<li>Word relations</li>
	</ul>
	</li>
	<li>Conceptual Semantics
	<ul>
		<li>Cognitive structure of meaning</li>
	</ul>
	</li>
</ul>

<p>Or, to put it a bit more concretely:</p>

<ul>
	<li>Semantics is the study of meaning</li>
	<li>It focuses on the relationship between:
	<ul>
		<li>Signifiers: words, phrases, signs and symbols</li>
		<li>
		<p>Denotation: what they stand for</p>
		</li>
	</ul>
	</li>
</ul>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p align="center"><i>“No word has a value that can be identified independently of what else is in its vicinity.”</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- (de Saussure, Ferdinand, 1916, The Course of General Linguistics)</p>

<h3>What is the Typical Concept of a Semantic Database?</h3>

<p>First off, the term "semantic database" is classically used in conjunction with the phrase "semantic data model<sup>1</sup>".&nbsp; And when you see the phrase "semantic data", this usually implies some association with the Semantic Web<sup>2</sup>, the Web Ontology Language (OWL)<sup>3</sup>, and the Resource Description Format (RDF)<sup>4</sup>.</p>

<h4>The Semantic Web</h4>

<p><i>"The semantic web is a vision of information that can be readily interpreted by machines, so machines can perform more of the tedious work involved in finding, combining, and acting upon information on the web.&nbsp; The Semantic Web, as originally envisioned, is a system that enables machines to "understand" and respond to complex human requests based on their meaning. Such an "understanding" requires that the relevant information sources be semantically structured."</i><sup>2</sup></p>

<h4>OWL and RDF</h4>

<p>Unfortunately, the original concept and phrase, coined by Tim Berners-Lee (also the inventor of the World Wide Web) has been somewhat hijacked by OWL and RDF.&nbsp; OWL and RDF primarily focus on what is known as "triples" -- subject-predicate-object expressions, where "[t]he subject denotes the resource, and the predicate denotes traits or aspects of the resource and expresses a relationship between the subject and the object."<sup>4</sup>&nbsp; The roots of this can be traced to the 1960's, when "Richard Montague proposed a system for defining semantic entries in the lexicon in terms of the lambda calculus. In these terms, the syntactic parse of the sentence John ate every bagel would consist of a subject (John) and a predicate (ate every bagel); Montague demonstrated that the meaning of the sentence altogether could be decomposed into the meanings of its parts and in relatively few rules of combination."<sup>8</sup></p>

<p>However, this correlates very poorly with the pure concept of semantics, especially with regards to relationships and structure.&nbsp; While a subject-predicate-object expression defines the relationship between the subject and object, it in no way defines the relationship <i>between</i> subjects, and <i>between</i> objects.&nbsp; Furthermore, an S-P-O also fails to express the <i>composition</i>, or <i>structure</i> of an object or subject, which, from a semantic perspective, is critical.</p>

<p>Obviously one can, with little thought, create a database of subject-predicate-object triples.&nbsp; One can then even query the database for kinds of relationships (via their predicates) that subject have to all objects in the domain (or objects and their subjects.)&nbsp; The problem is, this approach leaves one open to the challenges of the semantic web: "vastness, vagueness, uncertainty, inconsistency, and deceit."<sup>2</sup> Why?&nbsp; Because triples do not actually convey much meaning in a machine usable sense and are therefore prone to the aforementioned issues.&nbsp; Ironically, while a triple includes the relationship between subject and object, it does not say anything about the structure of the subject or the object (or even the predicate, which could have its own structure as well.)&nbsp; Take, for example, the issue of underspecification:</p>

<p><i>"...meanings are not complete without some elements of context. To take an example of one word, red, its meaning in a phrase such as red book is similar to many other usages, and can be viewed as compositional.[6] However, the colours implied in phrases such as red wine (very dark), and red hair (coppery), or red soil, or red skin are very different. Indeed, these colours by themselves would not be called red by native speakers. These instances are contrastive, so red wine is so called only in comparison with the other kind of wine (which also is not white for the same reasons)."</i><sup>6</sup></p>

<p>If the full structure is persisted along with the data ("red"):</p>

<p><img border="0" height="152" src="/KB/recipes/832959/colors.png" width="589"></p>

<p>and that structure is retrieved when querying for, say "things that are red", then its meaning is not ambiguous.&nbsp;</p>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> We note that the parent elements are valueless -- they are only placeholders referencing the child element "Color."</p>

<h3>What is the "Correct" Concept of a Semantic Database?</h3>

<p>Like Alice in Wonderland, we have to go down a few rabbit holes to figure this out.&nbsp;</p>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p align="center"><i>"Many sites are generated from structured data, which is often stored in databases. When this data is formatted into HTML, it becomes very difficult to recover the original structured data. Many applications, especially search engines, can benefit greatly from direct access to this structured data."</i><sup>5</sup></p>

<p>In other words, by exposing the semantics of the data, machines can then utilize the information in more interesting ways than just storing it or displaying it.&nbsp; A classic example is a website that contains a phone number.&nbsp; If the phone number is has a semantic tag, then your smart phone can easily offer it up as number to dial.&nbsp; Contrast this with the hoops an application has to go through to scan a page and find text that matches any number of styles of presenting a phone number, validating that it is actually a number rather than a math expression that looks like "619-555-1212", etc.</p>

<h4>Structured Data</h4>

<p>In the above quote, you'll notice the phrase "<i>recover the original structured data.</i>"&nbsp; This implies that the data has structure -- it's not just a field, but the fields mean something and can have sub-structures -- in other words, the structured data is a tree.</p>

<p>Here's a couple examples:</p>

<p align="center"><img border="0" height="244" src="/KB/recipes/832959/latlon.png" width="188">&nbsp;&nbsp;&nbsp;&nbsp; <img border="0" height="169" src="/KB/recipes/832959/sphone.png" width="432"></p>

<p>Next, we need to understand the concept of "ontology", a term that is often involved in discussions regarding semantics.</p>

<h4>Ontology</h4>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p align="center"><i>"An ontology is an explicit specification of a conceptualization."</i><br>
&nbsp; -- Gruber, Tom (1993); "A Translation Approach to Portable Ontology Specifications", in Knowledge Acquisition, 5: 199-199</p>

<p>Earlier I pointed out that the S-P-O triple does not define the relationship <i> between</i> subjects, and <i>between</i> objects.&nbsp; This is where ontology comes in.&nbsp; While in the abstract, "ontology" means "the branch of metaphysics dealing with the nature of being," in information science,<i> "an ontology is defined as a formal, explicit specification of a shared conceptualization. It provides a common vocabulary to denote the types, properties and interrelationships of concepts in a domain."</i><sup>9</sup><i> </i>And notice:<i> "Ontologies are the structural frameworks for organizing information and are used in ...the <u>Semantic Web</u>..."&nbsp; </i></p>

<p>Semantics are useful for understanding the structure of a "thing", however we need ontologies to relate things with other things.&nbsp; Therefore, one would expect that a semantic database be relational -- it should be able to relate structured data into ontologies.</p>

<p>Here is an example instance of the Friend of a Friend<sup>10</sup> ontology (from the W3C SKOS Core Guide<sup>11</sup>):</p>

<p align="center"><img border="0" height="506" src="/KB/recipes/832959/foaf.png" width="613"></p>

<p>The SKOS Core Vocabulary defines two properties of a semantic relationship:</p>

<ol>
	<li>The relationship between the two structures defines one as being "broader" or "narrower" with relation to the other</li>
	<li>An associative relationship, in which the two structures are "related"</li>
</ol>

<p>In the world of the semantic web, and RDF Schema (RDFS)<sup>12</sup> is used to describe ontologies "...otherwise called RDF vocabularies, intended to structure RDF resources. These resources can be saved in a triplestore to reach them with the query language SPARQL."<sup>12</sup>&nbsp; For example: "A typical example of an rdfs:Class is foaf:Person in the Friend of a Friend (FOAF) vocabulary. An instance of foaf:Person is a resource that is linked to the class foaf:Person using the rdf:type property, such as in the following formal expression of the natural language sentence : 'John is a Person'."<sup>12</sup></p>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p>We see two concepts emerging:</p>

<ol>
	<li>The relationship between data structures is itself a hierarchical structure</li>
	<li>A semantic structure can be associated with another structure to create ontologies</li>
</ol>

<p>This guides us in understanding what a semantic database should provide.</p>

<h2>A Semantic Database</h2>

<p>In a semantic database (going back to the very early definition of semantics), the schema:</p>

<ol>
	<li>describes denotations</li>
	<li>describes relationships between denotations</li>
</ol>

<p>The job of the database then is to associate signifiers (values) to those denotations.&nbsp; Therefore:</p>

<ol>
	<li>Structure resolves to concrete properties to which instance values can be associated</li>
</ol>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p>Importantly though, <i>the structure is instantiated with each instance.</i>&nbsp; This allows the structure to be retrieved along with the value(s).&nbsp; We will see what this means (and why what I'm implementing is going to seem so controversial) later.</p>

<h3>Why not use a Relational Database?</h3>

<p>In the implementation section of this article, I'll be working a lot with RSS feeds, so let's take a look at a typical implementation in an RDBMS for persisting an RSS Feed and its entries.&nbsp; First off, the schema probably looks something like this:</p>


	
		
			
			
		
	
<table border="0" width="100%"><tbody><tr><td>
			<ul>
				<li>RSS_Feed_Name
				<ul>
					<li>Name : text</li>
				</ul>
				</li>
				<li>RSS_Feed_Item
				<ul>
					<li>FK_RSS_Feed_Name</li>
					<li>Title : text</li>
					<li>Description: text</li>
					<li>PubDate : date</li>
					<li>Url : text</li>
				</ul>
				</li>
				<li>RSS_UI
				<ul>
					<li>FK_RSS_Feed_Item</li>
					<li>Visited : bool</li>
					<li>Displayed : bool</li>
				</ul>
				</li>
			</ul>
			</td><td>
			<p align="center"><img border="0" height="132" src="/KB/recipes/832959/rdbms1.png" width="324"></p>
			</td></tr></tbody></table>

<p>(Here the RSS_UI is intended to persist whether a feed item has been displayed previously in a list or whether it is a new feed, and whether the user actually visited the URL associated with the feed item.)</p>

<p>Notice how the field names are high level abstractions.&nbsp; Given the field name, one has no idea whether the "Title" refers to an RSS feed, a book, or a the title given to a person.&nbsp; Adding "RSS_Feed_" to the field names is cumbersome and non-traditional.&nbsp; Furthermore, when we perform the query "select * from RSS_Feed_Item", we get a collection of rows in the order that the fields were described in the schema.&nbsp; However, these are just values -- we all too often forget that the data returned has actually no semantic meaning, it is the UI that labels the columns for us so we know what the data is.&nbsp;</p>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p>Even more importantly, in an RDBMS, relationships are driven by:</p>

<ul>
	<li>Cardinality</li>
	<li>Normalization rules</li>
	<li>"Logical" groupings of fields</li>
</ul>

<p>This process can be so automatic when we create a schema that we are hardly consciously aware that we are doing it.&nbsp; The result are associations that are not semantic but rather abstracted, un-natural structural relationships, (ideally) restricted to established foreign key declarations.</p>

<p>However, as we will see, we can implement a semantic database on top of an RDBMS.</p>

<h3>Why not use a NoSQL Database?</h3>

<p>NoSQL databases are document-oriented and they do not support relationships between documents such that one can construct a query that consists of joins that is handled by the database engine.&nbsp; Instead, in a NoSQL database, joins are resolved by the client, which requires potentially numerous round trips to the database to acquire all the information and then build it into a coherent structure.&nbsp; This makes NoSQL database completely unsuitable for the task at hand.</p>

<h3>Why not use a Graph Database?</h3>

<p>Graph databases do seem to be a possibility and will be investigated further.&nbsp; If we read about Neo4j:</p>

<p>From Neo4j's website:</p>

<p><i>"...a graph is just a collection of vertices and edges—or, in less intimidating language,a set of nodes and the relationships that connect them. Graphs represent entities as nodes and the ways in which those entities relate to the world as relationships." -</i> Robinson, Ian, &amp; Webber, Jim, &amp; Eifrem, Emil (2013). <i>Graph Databases.</i> O'Reilly, pg 1 (free download <a href="http://www.graphdatabases.com/">here</a>.)</p>

<p>Importantly, with regards to traditional relational databases:</p>

<p><i>"...relational databases were initially designed to codify paper forms and tabular structures—something they do exceedingly well—they struggle when attempting to model the ad hoc, exceptional relationships that crop up in the real world. Ironically, relational databases deal poorly with relationships.&nbsp; Relationships do exist in the vernacular of relational databases, but only as a means of joining tables. In our discussion of connected data in the previous chapter, we mentioned we often need to disambiguate the semantics of the relationships that connect entities, as well as qualify their weight or strength. Relational relations do nothing of the sort." </i>- (ibid, pg 11)</p>

<p>And:</p>

<p><i>"Relationships are first-class citizens of the graph data model, unlike other database management systems, which require us to infer connections between entities using contrived properties such as foreign keys, or out-of-band processing like map-reduce. By assembling the simple abstractions of nodes and relationships into connected structures, graph databases enable us to build arbitrarily sophisticated models that map closely to our problem domain. The resulting models are simpler and at the same time more expressive than those produced using traditional relational databases and the other NOSQL stores."</i> - (ibid, pg 6)</p>

<p>However, it would appear that a typical graph database focuses on the ontology of information -- it has no concept of the actual structures that define the properties of a node.&nbsp; This is a result of the concept of "facts":&nbsp; <i>"When two or more domain entities interact for a period of time, a fact emerges. We represent these facts as separate nodes, with connections to each of the entities engaged in that fact."</i> - (ibid, pg 66)</p>

<p>We can see this in the examples given for creating a graph database.&nbsp; From pg 41:</p>

<p align="center"><img border="0" height="137" src="/KB/recipes/832959/graphdb1.png" width="337"></p>

<p>We have "fact" nodes:</p>

<ul>
	<li>William Shakespeare</li>
	<li>The Tempest</li>
	<li>Juilias Ceasar</li>
</ul>

<p>This information lacks semantic context, for example indicating that "William Shakespeare" is a playwright or that "The Tempest" is a play.&nbsp; Interestingly, this semantic information becomes an arbitrary label in the Cypher<sup>14</sup> query fragment <code>bard=node:author(lastname='Shakespeare')</code>.&nbsp; From the query we can determine that William Shakespeare is a bard, however, this information is completely lost in the graph database!&nbsp;</p>

<p>To put it another way, if we follow the "fact" best practice, it becomes impossible to query a graph database for data by specifying a semantic context.&nbsp; I cannot ask the graph database "show me all the people that are bards" unless I explicitly create a node called "bard" with a relationship to William Shakespeare.&nbsp; This problem stems partially from the fact that a graph database represents a specific domain: <i>"By assembling the simple abstractions of nodes and relationships into connected structures, graph databases enable us to build arbitrarily sophisticated models that map closely to our problem domain."</i> - (ibid, pg 6).&nbsp; At best, we can say a node with properties "firstname" and "lastname" represents a "person", but we can say nothing else about that person, such as distinguishing the person from the playwright, the producer, or the actor, <i>except</i> through a relationship with another concrete node, where the relationship provides further semantic meaning, such as "wrote_play", or "produced_play" or "acted_in".&nbsp;</p>

<p>Therefore, with regards to semantic structure, a graph database, while an excellent tool for creating ontologies of concrete entities, is not appropriate for abstract structural elements that have semantic significance but no values (which would have to be represented as nodes without properties), nor does a graph database properly semanticize property values, except as "field names" which, like traditional databases, the semantics are not accessible as part of the data.</p>

<p>Nonetheless, there is much guidance in the literature on graph databases that is valuable when designing a semantic database, and that is:</p>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p align="center"><i>There is relevant meaning in the connections between semantic structures comprising the ontology.</i></p>

<h2>A Semantic Database Architecture</h2>

<p>In the above discussion, we come to several important observations:</p>

<ol>
	<li>An ontology emphases the relationship of entities rather than defining the entity structure.</li>
	<li>Semantics emphasizes the structure but not the relationships between structures (the ontology.)</li>
</ol>

<p>Furthermore, with regards to current database options:</p>

<ol>
	<li>Graph databases typically capture ontologies of facts rather than semantics and their structures</li>
	<li>Relational databases capture "logical" relationships rather than "natural" semantic structures and ontologies</li>
	<li>NoSQL databases require that the client provides the implementation for supporting relationships, the only support NoSQL provides is a very limited "document ID" scaffolding.</li>
</ol>

<p>What is needed is with regards to a semantic database is:</p>

<ol>
	<li>The ability to create ontologies from semantics</li>
	<li>The ability to define the natural structure of the semantic elements</li>
</ol>

<p>Using our RSS_Feed_Item example, we can put together a mockup of what the natural structure of the concept "RSS_Feed_Item" looks like:</p>

<ul>
	<li>RSS_Feed_Item
	<ul>
		<li>RSS_Feed_Name
		<ul>
			<li>Name
			<ul>
				<li>Text
				<ul>
					<li>Value : text</li>
				</ul>
				</li>
			</ul>
			</li>
		</ul>
		</li>
		<li>RSS_Feed_Title
		<ul>
			<li>Title
			<ul>
				<li>Text
				<ul>
					<li>Value : text</li>
				</ul>
				</li>
			</ul>
			</li>
		</ul>
		</li>
		<li>RSS_Feed_Description
		<ul>
			<li>Description
			<ul>
				<li>Text
				<ul>
					<li>Value : text</li>
				</ul>
				</li>
			</ul>
			</li>
		</ul>
		</li>
		<li>RSS_Feed_PubDate
		<ul>
			<li>Publication_Date
			<ul>
				<li>Date
				<ul>
					<li>Value : date</li>
				</ul>
				</li>
			</ul>
			</li>
		</ul>
		</li>
		<li>RSS_Feed_Url
		<ul>
			<li>URL
			<ul>
				<li>Text (see comment below)
				<ul>
					<li>Value : text</li>
				</ul>
				</li>
			</ul>
			</li>
		</ul>
		</li>
	</ul>
	</li>
</ul>

<p>(It certainly can also be argued that "URL" should be broken down into scheme name, domain name and resource path, but we'll keep it simple for now.)</p>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p align="left">The first thing to note with this structure is that queries can queries can be made at any level in the structure with varying degrees of meaning loss.&nbsp; For example, the query “select URL from RSS_Feed_Url” has some contextual loss, as we still know that the values are associated with a URL structure, but URL is no longer identified as being an RSS Feed URL.&nbsp; A query like “select Value from URL” has complete contextual loss -- all we get back are a collection of strings.&nbsp; Incidentally, this is the equivalent of querying an RDBMS “select URL from RSS_Feed_Item”.&nbsp; In the semantic database implementation that I propose here, the query "select Value from URL" would actually not be possible because Value is a native type, not a semantic type.</p>

<h3 align="left">Using an RDMS to host a Semantic Database</h3>

<p align="left">However, a semantic database can be built on top of an RDBMS.&nbsp; We can leverage useful features of an RDBMS:</p>

<ul>
	<li>
	<p align="left">foreign key constraints</p>
	</li>
	<li>
	<p align="left">server-side joins</p>
	</li>
	<li>
	<p align="left">unique key constraints</p>
	</li>
	<li>
	<p align="left">unique key indexing</p>
	</li>
</ul>

<p align="left">When hosted by an RDBMS, we see the following artifacts:</p>

<ul>
	<li>
	<p align="left">Tables represent structure</p>
	</li>
	<li>
	<p align="left">Foreign keys describe sub-structures</p>
	</li>
	<li>
	<p align="left">Joins are used to join together structures</p>
	</li>
	<li>
	<p align="left">In a left join, all-null native types for a semantic type takes on the specific meaning that there is no structure instance</p>
	</li>
	<li>
	<p align="left">The primary key is almost exclusively relegated to the role of resolving joins through the foreign key</p>
	</li>
	<li>
	<p align="left">There is significant more emphasis on the unique key (single field or composite) for performing insert, update, and delete transactions on native types.</p>
	</li>
</ul>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p>Contrary to an RDBMS, where relationships are driven by cardinality, normalization, and logical structuring of fields, in a semantic database, relationships are driven by the semantic structure itself.&nbsp; This, by its very nature, allows a semantic database to be more adaptive to new structures that encapsulate new meaning.</p>

<h3>Unfolding a Semantic Database Structure</h3>

<p>Using the RSS feed example, an unfolded structure of tables in a database would look something like this:</p>

<p><img border="0" height="324" src="/KB/recipes/832959/struct1.png" width="798"><br>
<br>
Notice that there are only two tables with actual values (Text and URL).&nbsp; Everything else is "substrate" - it's there only for its structural relevance and consists only of foreign keys pointing the next layer of generalized concept.&nbsp; While most structures have 1:1 relationships with their generalization, we see that RSS_Feed_Item is a composite of four distinct structures (this is its specific ontology.)&nbsp;</p>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p>In object oriented terms, we can clearly see the "is a kind of" and "has a" relationships, however, it should be noted that a semantic database is in no way an implementation of an OODBMS, again for the same reason -- objects tend to be logical constructs for the convenience of the programmer rather than natural semantic constructs.&nbsp; However, a semantic structure quite naturally fits into the OO paradigm.</p>

<h3>Folding a Semantic Database Structure</h3>

<p>The typical structure however is illustrated more cleanly as a tree:</p>

<p><img border="0" height="354" src="/KB/recipes/832959/struct2.png" width="687"></p>

<h3>Implementation in an RDBMS</h3>

<p>This is what the schema looks like in an RDBMS (and this is where I really start getting the "you're crazy" looks):</p>

<p><img border="0" height="526" src="/KB/recipes/832959/sdmodel-subset.png" width="744"><br>
<img border="0" height="32" src="/KB/recipes/832959/note.png" width="24">&nbsp; Two things stand out:</p>


	
		
			
			
		
		
			
			
		
	
<table border="0" width="100%"><tbody><tr><td width="302"><img border="0" height="142" src="/KB/recipes/832959/rssfeeditem.png" width="199"></td><td>The “deepest” semantic types are almost always composed just of foreign keys.</td></tr><tr><td width="302"><img border="0" height="57" src="/KB/recipes/832959/nt1.png" width="251"></td><td>Tables with native types are very “thin”, having very few fields.</td></tr></tbody></table>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p align="left">What's interesting about this implementation is that we can now ask some potentially useful questions:</p>

<ul>
	<li>
	<p align="left">What are all the URL’s in the database?</p>
	</li>
	<li>
	<p align="left">What are the URL’s we have visited?</p>
	</li>
	<li>
	<p align="left">What URL’s are associated with feeds?</p>
	</li>
	<li>
	<p align="left">What are all the values of “Title”?</p>
	</li>
	<li>
	<p align="left">What are all the feed names?</p>
	</li>
</ul>

<p>These are not questions that we can necessarily ask of an RDBMS, especially when a more general concept like "URL" is embedded as a field across multiple tables: RSS Feed URL's, browser bookmark URL's, document embedded URL's, etc.&nbsp; Even a well-architected database will have its limitations.</p>

<p>Furthermore, because of how the more general semantic types are joined to contextual types, we can ask:</p>

<ul>
	<li>Which feed items have I visited?</li>
	<li>Which feed items are bookmarked (I did not show the bookmark semantic types in the diagram)</li>
</ul>

<p>Even more importantly (as an example), when we visit a page in a browser, we can use the same more generalized URL type with a specialized "browser visited" type, allowing us to ask specifically:</p>

<ul>
	<li>What are all the feed items I've visited?</li>
	<li>What are all the web pages I've visited directly in my browser?</li>
	<li>What are all the URL's in total that I've visited?</li>
</ul>

<p>Hopeful this demonstrates how a semantic database can adapt to new structures that then creates new contexts that can then be queried in new ways.&nbsp;</p>

<h3>Some Benefits of a Semantic Database</h3>

<ul>
	<li>By preserving semantic structure, we can query the database at different levels of semantic meaning, from very specific to very general.
	<ul>
		<li>For example, the semantic type “Title” is very general but allows us to ask “what are all the values of things having the meaning “Title”?</li>
	</ul>
	</li>
	<li>By inspecting the relationships, we can ask “what are the things having “Title” in their meaning?</li>
	<li>When we query the database, we don’t just get back a list of records – we get back fully “rehydrated” semantic types.</li>
	<li>In actual implementation, the need for an ORM layer is eliminated:
	<ul>
		<li>We pass in semantic structures as actual C# objects</li>
		<li>We get back semantic structures as actual C# objects</li>
	</ul>
	</li>
</ul>

<h3>Some Drawbacks of a Semantic Database</h3>

<ul>
	<li>Tables and their fields are organized by hierarchical rather than logical structure:
	<ul>
		<li>We usually think about organizing information into logical associations and relationships</li>
		<li>Hierarchical organization creates many more tables
		<ul>
			<li>The number of joins in a query can degrade performance.</li>
			<li>Multiple insert operations are required to create the semantic type’s hierarchy.</li>
		</ul>
		</li>
		<li>Designing hierarchies isn’t easy
		<ul>
			<li>We need to learn how to think about multiple levels of abstraction.</li>
			<li>We need to think carefully about unique native types and unique semantic types.</li>
		</ul>
		</li>
		<li>Writing SQL queries by hand is painful:
		<ul>
			<li>lots of joins, often with multiple references to the native type tables making it hard to keep track of which FK join is associated with what meaning-value.</li>
		</ul>
		</li>
		<li>Writing insert statements by hand is even more painful:
		<ul>
			<li>multiple inserts from the bottom up, requiring the ID of the child table to populate the foreign key in the parent table.</li>
		</ul>
		</li>
	</ul>
	</li>
</ul>

<h3>Addressing Some of the Drawbacks</h3>

<p>A Semantic Database engine can address some of these drawbacks:</p>

<ul>
	<li>Automating SQL query generation
	<ul>
		<li>Hides the hierarchy and table joins</li>
	</ul>
	</li>
	<li>Automating SQL inserts
	<ul>
		<li>Managing all the necessary FK ID’s</li>
	</ul>
	</li>
	<li>Improving Performance
	<ul>
		<li>Caching queries so the engine doesn’t have to re-create the SQL statement every time.</li>
		<li>Use prepared statements so the server isn’t parsing and analyzing the query statement every time it’s used.</li>
	</ul>
	</li>
</ul>

<h2>Prototyping and Implementation</h2>

<p>A semantic database naturally deals with semantic structures.&nbsp; As I've already implemented a great deal of the infrastructure in the Higher Order Programming Environment (HOPE) project (the up to date list of articles can be found by visiting <a href="http://www.higherorderprogramming.com/developers-1-1-2/">here</a>), I will be taking advantage of that code base.</p>

<p align="center"><img border="0" height="33" src="/KB/recipes/832959/key-small.jpg" width="94"></p>

<p>It is highly recommended that the introductory articles are reviewed to help understand the following code.&nbsp; In the real demonstration that follows this section, I'll be taking advantage of the semantic editor and various "receptor" components, the semantic database being implemented as one such receptor.</p>

<h3>Unit Tests</h3>

<p>Unit tests are vital for verifying the expected behaviors when the user is expecting to trust our ability to properly persist and retrieve data (which is one of the reasons I'm also building this on top of an RDBMS rather than writing a completely new semantic database implementation.)&nbsp; Unit tests are also a good way of introducing the concepts and implementation of the semantic database.&nbsp;</p>

<p>You will notice the unit test structure as, basically:</p>

<ul>
	<li>Clean up the database for every test - this involves dropping tables</li>
	<li>Create the semantic structures and their configurations that will test the desired behaviors</li>
	<li>Register these structures with the semantic database - this creates the backing tables</li>
	<li>Perform the desired transactions</li>
	<li>Verify the results.</li>
</ul>

<p>An important consideration when working with any RDBMS, and this is true with regards to the semantic database as well, is the concept of unique keys, either single or composite fields.&nbsp; However, the semantic database also implements the concept of unique key "types", where the type is the semantic element.&nbsp; This creates some interesting behaviors for which need to test, and the tests will help to document how to use the unique key field / type configurations.</p>

<h4>Database Configuration</h4>

<p>If you run the tests with a SQLite database, there is no configuration required -- the database file is created automatically and there are no permission issues.&nbsp; The semantic database also supports Postgres, which requires that:</p>

<ol>
	<li>a "postgres.config" file be placed in the "HOPE\UnitTests\SemanticDatabaseTests\bin\Debug" folder.&nbsp; This file should consist of two lines:
	<ol>
		<li>The username</li>
		<li>The password</li>
	</ol>
	</li>
	<li>You will also need to manually create an empty database (no tables) called "test_semantic_database"</li>
</ol>

<h4>Creating Tables From Semantic Structures</h4>

<p>This code:</p>

<pre>InitializeSDRTests(() =<span class="code-keyword">&gt;</span> InitLatLonNonUnique());
sdr.Protocols = <span class="code-string">"</span><span class="code-string">LatLon"</span>;
sdr.ProtocolsUpdated();</pre>

<p>initializes the semantic database receptor and defines a semantic structure for "LatLon".&nbsp; When <code>ProtocolsUpdated</code> is called, the semantic database creates the table "LatLon" with two fields, "latitude" and "longitude".&nbsp; Tables are automatically created when a new semantic type is encountered.&nbsp; In this particular case, the semantic structure is instantiated thus:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitLatLonNonUnique()
{
  SemanticTypeStruct sts = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
}</pre>

<p>For our purposes, we won't worry about what decls or structs are, you can inspect the code in detail if you want to find out.&nbsp; The salient point is that a structure "LatLon" is created with two native types, both doubles, called "latitude" and "longitude."&nbsp; Neither the structure nor the native types are defined as unique.&nbsp;</p>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24">&nbsp; While it seems odd, the reason strings are used for type names -- rather than, say, <code>typeof(double)</code> -- is because we're actually simulating what would normally be done in the semantic editor, which, being a user interface component, works mostly with strings for the names of things.</p>

<p><img border="0" height="32" src="/KB/recipes/832959/database.png" width="32">The database implementation for creating the tables from a semantic structure is:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Create the table for the specified semantic structure, adding any SQL statements for making foreign key associations.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">void</span> CreateTable(<span class="code-keyword">string</span> st, List&lt;string&gt; fkSql)
{
  <span class="code-comment">//</span><span class="code-comment"> Fields and their types:</span>
  List&lt;Tuple&lt;string, Type&gt;&gt; fieldTypes = <span class="code-keyword">new</span> List&lt;Tuple&lt;string, Type&gt;&gt;();

  <span class="code-comment">//</span><span class="code-comment"> Get the structure object backing the structure name.</span>
  ISemanticTypeStruct sts = rsys.SemanticTypeSystem.GetSemanticTypeStruct(st);

  CreateFkSql(sts, fieldTypes, fkSql);
  CreateNativeTypes(sts, fieldTypes);
  dbio.CreateTable(<span class="code-keyword">this</span>, st, fieldTypes);
}

<span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Any reference to a child semantic element is implemented as a foreign key.
</span><span class="code-summarycomment">///</span><span class="code-comment"> Returns any foreign key creation sql statements in fkSql.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">void</span> CreateFkSql(ISemanticTypeStruct sts, List&lt;Tuple&lt;string, Type&gt;&gt; fieldTypes, List&lt;string&gt; fkSql)
{
  <span class="code-comment">//</span><span class="code-comment"> Create FK&#39;s for child SE&#39;s.</span>
  sts.SemanticElements.ForEach(child =<span class="code-keyword">&gt;</span>
  {
    <span class="code-keyword">string</span> fkFieldName = <span class="code-string">"</span><span class="code-string">FK_"</span> + child.Name + <span class="code-string">"</span><span class="code-string">ID"</span>;
    fieldTypes.Add(<span class="code-keyword">new</span> Tuple&lt;string, Type&gt;(fkFieldName, <span class="code-keyword">typeof</span>(<span class="code-keyword">long</span>)));
    fkSql.Add(dbio.GetForeignKeySql(sts.DeclTypeName, fkFieldName, child.Name, <span class="code-string">"</span><span class="code-string">ID"</span>));
  });
}

<span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> The supported native types are simple field name - Type tuples.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">void</span> CreateNativeTypes(ISemanticTypeStruct sts, List&lt;Tuple&lt;string, Type&gt;&gt; fieldTypes)
{
  <span class="code-comment">//</span><span class="code-comment"> Create fields for NT&#39;s.</span>
  sts.NativeTypes.ForEach(child =<span class="code-keyword">&gt;</span>
  {
    Type t = child.GetImplementingType(rsys.SemanticTypeSystem);

    <span class="code-keyword">if</span> (t != <span class="code-keyword">null</span>)
    {
      fieldTypes.Add(<span class="code-keyword">new</span> Tuple&lt;string, Type&gt;(child.Name, t));
    }
    <span class="code-keyword">else</span>
    {
      <span class="code-comment">//</span><span class="code-comment"> TODO: The reason for the try-catch is to deal with implementing types we don&#39;t support yet, like List&lt;SomeType&gt;</span>
      <span class="code-comment">//</span><span class="code-comment"> For now, we create a stub type.</span>
      fieldTypes.Add(<span class="code-keyword">new</span> Tuple&lt;string, Type&gt;(child.Name, <span class="code-keyword">typeof</span>(<span class="code-keyword">string</span>)));
    }
  });
}</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> The object <code>dbio</code> is an interface supporting the connection and syntax nuances for different physical databases such as SQLite, Postgres, SQL Server, etc.</p>

<p>Once created, we can inspect the database for, in this case, a very simple implementation.&nbsp; Here's what Postgres says about the table created by the above code:</p>

<pre>CREATE TABLE latlon
(
  id serial NOT NULL,
  latitude <span class="code-keyword">double</span> precision,
  longitude <span class="code-keyword">double</span> precision,
  CONSTRAINT latlon_pkey PRIMARY KEY (id)
)</pre>

<p>Each of our unit tests drops tables and recreates them to clear out the data from previous tests.</p>

<h4>A Simple Non-Unique Key Insert Test</h4>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; This test verifies that when we insert identical information, we get two records back:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Verifies that a non-unique ST with 2 NT&#39;s generates multiple records for the same data.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span>[TestMethod]
<span class="code-keyword">public</span> <span class="code-keyword">void</span> SimpleNonUniqueInsert()
{
  InitializeSDRTests(() =<span class="code-keyword">&gt;</span> InitLatLonNonUnique());

  <span class="code-comment">//</span><span class="code-comment"> Initialize the Semantic Data Receptor with the signal it should be listening to.</span>
  DropTable(<span class="code-string">"</span><span class="code-string">Restaurant"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">LatLon"</span>);
  sdr.Protocols = <span class="code-string">"</span><span class="code-string">LatLon"</span>;
  sdr.ProtocolsUpdated();

  <span class="code-comment">//</span><span class="code-comment"> Create the signal.</span>
  ICarrier carrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">LatLon"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.latitude = <span class="code-digit">1</span>.<span class="code-digit">0</span>;
    signal.longitude = <span class="code-digit">2</span>.<span class="code-digit">0</span>;
  });

  <span class="code-comment">//</span><span class="code-comment"> Let&#39;s see what the SDR does.</span>
  sdr.ProcessCarrier(carrier);
  IDbConnection conn = sdr.Connection;

  <span class="code-keyword">int</span> count;
  IDbCommand cmd = conn.CreateCommand();
  cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
  count = Convert.ToInt32(cmd.ExecuteScalar());
  Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 LatLon record."</span>);

  <span class="code-comment">//</span><span class="code-comment"> Insert another, identical record. We should now have two records.</span>
  sdr.ProcessCarrier(carrier);
  cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
  count = Convert.ToInt32(cmd.ExecuteScalar());
  Assert.AreEqual(<span class="code-digit">2</span>, count, <span class="code-string">"</span><span class="code-string">Expected 2 LatLon records."</span>);

  sdr.Terminate();
}</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> In the above code, a "carrier" is created.&nbsp; Carriers are like little messenger pigeons that are used to communicate between receptors.&nbsp; Because the semantic database is implemented within a receptor, we have to pretend to send it a message.&nbsp; You can review <a href="http://www.higherorderprogramming.com/developers-1-1-2/"> the previous articles on HOPE</a> to learn more about carriers, protocols, and signals, but the basic idea here is that we are creating a carrier for the protocol "LatLon" (whose semantic structure we defined earlier) and assigning values to the native type fields.&nbsp; The semantic engine generates the C# code for each semantic structure and instantiates it for us.&nbsp; Taking advantage of the <code>dynamic</code> keyword, we can then assign values to the properties without requiring a C# <code>interface</code> declaration.</p>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24">The reason we don't explicitly state "insert" somewhere in this carrier is because in the grand scheme of things, all we want to do is listen for particular semantic instances (protocol-signal), and if we see one, we persist it.&nbsp; The front-end UI allows us to choose which semantic types we persist, but the advantage is that any "receptor" emitting a particular protocol doesn't care about whether it's persisted or not -- basically, we've turned persistence into an optional component, decoupling it completely from any other computational units.&nbsp; This also means that we can implement different persistence mechanisms, traditional RDBMS, graph, even NoSQL, Excel export, etc.</p>

<p><img border="0" height="32" src="/KB/recipes/832959/database.png" width="32">What's going on when we pass in a semantic structure?&nbsp; This triggers the insert/update algorithm, though we'll be focusing only on inserts in this article.&nbsp; The exposed "API" function sets up some initial state variables and calls a recursive method:</p>

<pre><span class="code-keyword">string</span> st = carrier.Protocol.DeclTypeName;

<span class="code-comment">//</span><span class="code-comment"> Get the STS for the carrier&#39;s protocol:</span>
ISemanticTypeStruct sts = rsys.SemanticTypeSystem.GetSemanticTypeStruct(st);
Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap = <span class="code-keyword">new</span> Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt;();

ProcessSTS(stfkMap, sts, carrier.Signal);</pre>

<p>Structures need to be inserted into the database from the bottom up to ensure foreign key integrity.&nbsp; The method <code>ProcessSTS</code>&nbsp; does this by drilling down to the lowest structural elements -- the ones that implement only native types.&nbsp; The top level function is straight forward, recursing into child semantic elements until the semantic element "bottoms out" into just native types:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Drills into any child semantic elements, accumulating foreign keys for each level in the semantic hierarchy.
</span><span class="code-summarycomment">///</span><span class="code-comment"> When all children are inserted/updated, the parent can be inserted.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">int</span> ProcessSTS(Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap, ISemanticTypeStruct sts, <span class="code-keyword">object</span> signal, <span class="code-keyword">bool</span> childAsUnique = <span class="code-keyword">false</span>)
{
  <span class="code-comment">//</span><span class="code-comment"> Drill into each child ST and assign the return ID to this ST&#39;s FK for the child table name.</span>
  ProcessChildren(stfkMap, sts, signal, childAsUnique);

  <span class="code-comment">//</span><span class="code-comment"> Having processed all child ST&#39;s, We can now make the same determination of</span>
  <span class="code-comment">//</span><span class="code-comment"> whether the record needs to check for uniqueness, however at this level,</span>
  <span class="code-comment">//</span><span class="code-comment"> we need to write out both ST and any NT values in the current ST structure.</span>
  <span class="code-comment">//</span><span class="code-comment"> This is very similar to an ST without child ST&#39;s, but here we also use ST&#39;s that are designated as unique to build the composite key.</span>
  <span class="code-keyword">int</span> id = ArbitrateUniqueness(stfkMap, sts, signal, childAsUnique);

<span class="code-keyword">return</span> id;
}</pre>

<p>When the algorithm bottoms out, the data is checked for unique semantic elements and native types, which determines whether to allow duplicates to be inserted and whether to perform an update or an insert.&nbsp;</p>

<p>As the algorithm works back up the semantic tree, the id's of the children are accumulated so that they can populate the parent's foreign key fields:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> For each child that has a non-null signal, process its children.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">void</span> ProcessChildren(Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap, ISemanticTypeStruct sts, <span class="code-keyword">object</span> signal, <span class="code-keyword">bool</span> childAsUnique)
{
  sts.SemanticElements.ForEach(child =<span class="code-keyword">&gt;</span>
  {
    <span class="code-comment">//</span><span class="code-comment"> Get the child signal and STS and check it, returning a new or existing ID for the entry.</span>
    ISemanticTypeStruct childsts = child.Element.Struct; <span class="code-comment">//</span><span class="code-comment"> rsys.SemanticTypeSystem.GetSemanticTypeStruct(child.Name);</span>
    <span class="code-keyword">object</span> childSignal = GetChildSignal(signal, child);

    <span class="code-comment">//</span><span class="code-comment"> We don&#39;t insert null child signals.</span>
    <span class="code-keyword">if</span> (childSignal != <span class="code-keyword">null</span>)
    {
      <span class="code-keyword">int</span> id = ProcessSTS(stfkMap, childsts, childSignal, (sts.Unique || childAsUnique));
      RegisterForeignKeyID(stfkMap, sts, child, id);
    }
  });
}</pre>

<p>Each child ID is associated with its name (auto-generated by the semantic database engine) and its parent semantic element, such that each semantic element has a list of 0 or more foreign key relations when all the children have been processed:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Registers a foreign key name and value to be associated with the specified semantic structure, which is used when the ST is inserted
</span><span class="code-summarycomment">///</span><span class="code-comment"> after all child elements have been resolved.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">void</span> RegisterForeignKeyID(Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap, ISemanticTypeStruct sts, ISemanticElement child, <span class="code-keyword">int</span> id)
{
  <span class="code-comment">//</span><span class="code-comment"> Associate the ID to this ST&#39;s FK for that child table.</span>
  <span class="code-keyword">string</span> fieldName = <span class="code-string">"</span><span class="code-string">FK_"</span> + child.Name + <span class="code-string">"</span><span class="code-string">ID"</span>;
  CreateKeyIfMissing(stfkMap, sts);
  stfkMap[sts].Add(<span class="code-keyword">new</span> FKValue(fieldName, id, child.UniqueField));
}</pre>

<p>The unique native type, semantic element (the foreign key and all child, grandchild, etc elements and native types) and semantic structure (all child, grandchild, etc elements and native types) is arbitrated by checking various flags that are set for the specific semantic structure or by its parent.&nbsp; I realize that was a mouthful, so let's look at the code:</p>

<pre>	<span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Based on whether a semantic element is unique or whether the foreign key fields or native types are unique, we determine how to determine uniqueness.
</span><span class="code-summarycomment">///</span><span class="code-comment"> We always perform an insert if there is no way to determine whether the record is unique.
</span><span class="code-summarycomment">///</span><span class="code-comment"> If it is unique, the ID of the existing record is returned.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">param</span><span class="code-summarycomment"> </span><span class="code-summarycomment">name="stfkMap"</span><span class="code-summarycomment">&gt;</span><span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/param</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">int</span> ArbitrateUniqueness(Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap, ISemanticTypeStruct sts, <span class="code-keyword">object</span> signal, <span class="code-keyword">bool</span> childAsUnique)
{
  <span class="code-keyword">int</span> id = -1;

  <span class="code-keyword">if</span> (sts.Unique || childAsUnique)
  {
    <span class="code-comment">//</span><span class="code-comment"> All FK&#39;s and NT&#39;s of this ST are considered part of the composite key.</span>
    <span class="code-comment">//</span><span class="code-comment"> Get all NT&#39;s specifically for this ST (no recursive drilldown)</span>
    List&lt;IFullyQualifiedNativeType&gt; fieldValues = rsys.SemanticTypeSystem.GetFullyQualifiedNativeTypeValues(signal, sts.DeclTypeName, <span class="code-keyword">false</span>);
    id = InsertIfRecordDoesntExist(stfkMap, sts, signal, fieldValues, <span class="code-keyword">true</span>);
  }
  <span class="code-keyword">else</span> <span class="code-keyword">if</span> (sts.SemanticElements.Any(se =<span class="code-keyword">&gt;</span> se.UniqueField) || sts.NativeTypes.Any(nt =<span class="code-keyword">&gt;</span> nt.UniqueField))
  {
    <span class="code-comment">//</span><span class="code-comment"> Get only unique NT&#39;s specifically for this ST (no recursive drilldown)</span>
    <span class="code-comment">//</span><span class="code-comment"> Note that a unique semantic element will automatically set the unique field for its native type children, subchildren, etc.</span>
    List&lt;IFullyQualifiedNativeType&gt; fieldValues = rsys.SemanticTypeSystem.GetFullyQualifiedNativeTypeValues(signal, sts.DeclTypeName, <span class="code-keyword">false</span>).Where(fqnt =<span class="code-keyword">&gt;</span> fqnt.NativeType.UniqueField).ToList();
    id = InsertIfRecordDoesntExist(stfkMap, sts, signal, fieldValues, <span class="code-keyword">true</span>);
  }
  <span class="code-keyword">else</span>
  {
    <span class="code-comment">//</span><span class="code-comment"> No SE&#39;s or NT&#39;s are unique, so just insert the ST, as we cannot make a determination regarding uniqueness.</span>
    id = Insert(stfkMap, sts, signal);
  }

  <span class="code-keyword">return</span> id;
}</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> Not obvious is the fact that GetFullyQualifiedNativeTypeValues is returning structures that carry forward the parent element's uniqueness flag.&nbsp;</p>

<p>We have three states:</p>

<ol>
	<li>The structure or a parent structure is flagged as unique.&nbsp; This treats all foreign key and native type fields as comprising the composite unique key.</li>
	<li>One or more child elements (implemented as a foreign key) is unique or one or more native type elements is unique.&nbsp; The unique composite key consists exclusively of the unique foreign key and native type fields.</li>
	<li>There is no unique key.&nbsp; In this case, the structure is always inserted.</li>
</ol>

<p>Once we have some unique fields, we test to see whether it's unique and, if so insert it:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Insert the record if it doesn&#39;t exist.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">int</span> InsertIfRecordDoesntExist(Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap, ISemanticTypeStruct sts, <span class="code-keyword">object</span> signal, List&lt;IFullyQualifiedNativeType&gt; fieldValues, <span class="code-keyword">bool</span> childAsUnique)
{
  <span class="code-keyword">int</span> id = -1;
  <span class="code-keyword">bool</span> exists = QueryUniqueness(stfkMap, sts, signal, fieldValues, <span class="code-keyword">out</span> id, <span class="code-keyword">true</span>);

  <span class="code-keyword">if</span> (!exists)
  {
    id = Insert(stfkMap, sts, signal);
  }

  <span class="code-keyword">return</span> id;
}</pre>

<p>The new record's primary key ID is returned or the existing ID is returned.</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Build and execute a select statement that determines if the record, based on a composite key, already exists.
</span><span class="code-summarycomment">///</span><span class="code-comment"> If so, return the ID of the record.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">bool</span> QueryUniqueness(Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap, ISemanticTypeStruct sts, <span class="code-keyword">object</span> signal, List&lt;IFullyQualifiedNativeType&gt; uniqueFieldValues, <span class="code-keyword">out</span> <span class="code-keyword">int</span> id, <span class="code-keyword">bool</span> allFKs = <span class="code-keyword">false</span>)
{
  id = -1;
  <span class="code-keyword">bool</span> ret = <span class="code-keyword">false</span>;
  List&lt;FKValue&gt; fkValues;
  <span class="code-keyword">bool</span> hasFKValues = stfkMap.TryGetValue(sts, <span class="code-keyword">out</span> fkValues);
  StringBuilder sb = BuildUniqueQueryStatement(hasFKValues, fkValues, sts, uniqueFieldValues, allFKs); 
  IDbCommand cmd = AddParametersToCommand(uniqueFieldValues, hasFKValues, fkValues, allFKs);
  cmd.CommandText = sb.ToString();
  LogSqlStatement(cmd.CommandText);

  <span class="code-keyword">object</span> oid = cmd.ExecuteScalar();
  ret = (oid != <span class="code-keyword">null</span>);

  <span class="code-keyword">if</span> (ret)
  {
    id = Convert.ToInt32(oid);
  }

  <span class="code-keyword">return</span> ret;
}</pre>

<p>And finally, if an insert is required, we have this rather unwieldy piece of code to actually perform the insert:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">int</span> Insert(Dictionary&lt;ISemanticTypeStruct, List&lt;FKValue&gt;&gt; stfkMap, ISemanticTypeStruct sts, <span class="code-keyword">object</span> signal)
{
  <span class="code-comment">//</span><span class="code-comment"> Get native types to insert:</span>
  List&lt;IFullyQualifiedNativeType&gt; ntFieldValues = rsys.SemanticTypeSystem.GetFullyQualifiedNativeTypeValues(signal, sts.DeclTypeName, <span class="code-keyword">false</span>);
  StringBuilder sb = <span class="code-keyword">new</span> StringBuilder(<span class="code-string">"</span><span class="code-string">insert into "</span> + sts.DeclTypeName + <span class="code-string">"</span><span class="code-string"> ("</span>);
  sb.Append(<span class="code-sdkkeyword">String</span>.Join(<span class="code-string">"</span><span class="code-string">, "</span>, ntFieldValues.Select(f =<span class="code-keyword">&gt;</span> f.Name)));

  <span class="code-comment">//</span><span class="code-comment"> Get ST&#39;s to insert as FK_ID&#39;s:</span>
  List&lt;FKValue&gt; fkValues;
  <span class="code-keyword">bool</span> hasFKValues = stfkMap.TryGetValue(sts, <span class="code-keyword">out</span> fkValues);

  <span class="code-keyword">if</span> (hasFKValues &amp;&amp; fkValues.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>)
  {
    <span class="code-comment">//</span><span class="code-comment"> Join in the FK_ID field names.</span>
    <span class="code-keyword">if</span> (ntFieldValues.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>) sb.Append(<span class="code-string">"</span><span class="code-string">, "</span>);
    sb.Append(<span class="code-keyword">string</span>.Join(<span class="code-string">"</span><span class="code-string">, "</span>, fkValues.Select(fkv =<span class="code-keyword">&gt;</span> fkv.FieldName)));
  }

  <span class="code-comment">//</span><span class="code-comment"> Setup NT field values:</span>
  sb.Append(<span class="code-string">"</span><span class="code-string">) values ("</span>);
  sb.Append(<span class="code-sdkkeyword">String</span>.Join(<span class="code-string">"</span><span class="code-string">, "</span>, ntFieldValues.Select(f =<span class="code-keyword">&gt;</span> <span class="code-string">"</span><span class="code-string">@"</span> + f.Name)));

  <span class="code-comment">//</span><span class="code-comment"> Setup ST FK parameters:</span>
  <span class="code-keyword">if</span> (hasFKValues &amp;&amp; fkValues.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>)
  {
    <span class="code-keyword">if</span> (ntFieldValues.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>) sb.Append(<span class="code-string">"</span><span class="code-string">, "</span>);
    sb.Append(<span class="code-keyword">string</span>.Join(<span class="code-string">"</span><span class="code-string">, "</span>, fkValues.Select(fkv =<span class="code-keyword">&gt;</span> <span class="code-string">"</span><span class="code-string">@"</span> + fkv.FieldName)));
  }

  sb.Append(<span class="code-string">"</span><span class="code-string">)"</span>);
  IDbCommand cmd = dbio.CreateCommand();

  <span class="code-comment">//</span><span class="code-comment"> Assign NT values:</span>
  ntFieldValues.ForEach(fv =<span class="code-keyword">&gt;</span> cmd.Parameters.Add(dbio.CreateParameter(fv.Name, fv.Value)));

  <span class="code-comment">//</span><span class="code-comment"> Assign FK values:</span>
  <span class="code-keyword">if</span> (hasFKValues &amp;&amp; fkValues.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>)
  {
    fkValues.ForEach(fkv =<span class="code-keyword">&gt;</span> cmd.Parameters.Add(dbio.CreateParameter(fkv.FieldName, fkv.ID)));
  }

  cmd.CommandText = sb.ToString();
  LogSqlStatement(cmd.CommandText);
  cmd.ExecuteNonQuery();

  <span class="code-keyword">int</span> id = dbio.GetLastID(sts.DeclTypeName);

  <span class="code-keyword">return</span> id;
}</pre>

<h4>A Simple Unique Key Insert Test</h4>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; This test verifies that when we attempt to insert two identical records, the semantic database detects this, based on our semantic structure configuration, and ignores the second insert because it's a duplicate record.</p>

<p>Recall how the non-unique LatLon semantic structure was initialized:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitLatLonNonUnique()
{
  SemanticTypeStruct sts = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
}</pre>

<p>In this unit test, we initialize the structure slightly differently:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitLatLonUniqueFields()
{
SemanticTypeStruct sts = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>, decls, structs);
Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>);
Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>);
}<b>
);
</b>  Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">true</span>);
}</pre>

<p>Notice in this structure, we are declaring that the native type fields are both unique.&nbsp; This composite key comprises the unique fields, and we see that the semantic database ends up inserting only one record.</p>

<h4>A Simple Unique Structure Insert Test</h4>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; Again, this test verifies that when we attempt to insert two identical records, the semantic database detects this, based on our semantic structure configuration, and ignores the second insert because it's a duplicate record.&nbsp; In this case though, it is the semantic structure itself that is flagged as unique:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitLatLonUniqueST()
{
  SemanticTypeStruct sts = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>, decls, structs);
  Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(sts, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
}</pre>

<p>Here we're testing (in a simple way) that if a structure is declared as unique, then we don't have to bother setting any native type fields <i>anywhere in the hierarchy from here on</i> as unique.</p>

<h4>Two-Level Non-Unique Insert Test</h4>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; Here we do something a bit more interesting -- we're going create a simple two-level structure: a parent "Restaurant" and a child "LatLon", and verify that we get two records in both the Restaurant and LatLon tables.&nbsp;</p>

<p>First, let's look at the initialization of the semantic structure:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitRestaurantLatLonNonUnique()
{
  SemanticTypeStruct stsRest = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Restaurant"</span>, <span class="code-keyword">false</span>, decls, structs);
  SemanticTypeStruct stsLatLon = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateSemanticElement(stsRest, <span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>);
}</pre>

<p>We see that "Restaurant" has a "LatLon" element which is comprised of two native types, "latitude" and "longitude".&nbsp; Notice that "Restaurant" doesn't have any native types itself -- we don't really need or want any for this particular test -- we want to start simply.</p>

<p><img border="0" height="32" src="/KB/recipes/832959/database.png" width="32">On the database side, the semantic database creates the following tables (as described by Postgres):</p>

<pre>CREATE TABLE restaurant
(
  id serial NOT NULL,
  fk_latlonid bigint,
  CONSTRAINT restaurant_pkey PRIMARY KEY (id),
  CONSTRAINT restaurant_fk_latlonid_fkey FOREIGN KEY (fk_latlonid)
  REFERENCES latlon (id) MATCH SIMPLE
  ON UPDATE NO ACTION ON DELETE NO ACTION
)</pre>

<p>Notice the foreign key to the LatLon table (annoyingly, Postgres turns all tables and fields into lowercase).</p>

<p>The LatLon table hasn't changed:</p>

<pre>CREATE TABLE latlon
(
id serial NOT NULL,
latitude <span class="code-keyword">double</span> precision,
longitude <span class="code-keyword">double</span> precision,
CONSTRAINT latlon_pkey PRIMARY KEY (id)
)</pre>

<p>This unit test initializes the semantic structure slightly differently now because LatLon is an element of Restaurant:</p>

<pre><span class="code-bracket">[</span><span class="code-sdkkeyword">TestMethod<span class="code-none">]</span></span>
<span class="code-keyword">public</span> <span class="code-keyword">void</span> TwoLevelNonUniqueSTInsert()
{
  InitializeSDRTests(() =<span class="code-keyword">&gt;</span> InitRestaurantLatLonNonUnique());

  <span class="code-comment">//</span><span class="code-comment"> Initialize the Semantic Data Receptor with the signal it should be listening to.</span>
  DropTable(<span class="code-string">"</span><span class="code-string">Restaurant"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">LatLon"</span>);
  sdr.Protocols = <span class="code-string">"</span><span class="code-string">LatLon; Restaurant"</span>;
  sdr.ProtocolsUpdated();

  <span class="code-comment">//</span><span class="code-comment"> Create the signal.</span>
  ICarrier carrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">Restaurant"</span>, signal =<span class="code-keyword">&gt;</span>
  {
&lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>    signal.LatLon.latitude = <span class="code-digit">1</span>.<span class="code-digit">0</span>;
    signal.LatLon.longitude = <span class="code-digit">2</span>.<span class="code-digit">0</span>;
</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>  });

  <span class="code-comment">//</span><span class="code-comment"> Let&#39;s see what the SDR does.</span>
  sdr.ProcessCarrier(carrier);
  IDbConnection conn = sdr.Connection;

  <span class="code-keyword">int</span> count;
  IDbCommand cmd = conn.CreateCommand();
  cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
  count = Convert.ToInt32(cmd.ExecuteScalar());
  Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 LatLon record."</span>);
  cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
  count = Convert.ToInt32(cmd.ExecuteScalar());
  Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 Restaurant record."</span>);

  <span class="code-comment">//</span><span class="code-comment"> Insert another, identical record. We should still have one record.</span>
  sdr.ProcessCarrier(carrier);
  cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
  count = Convert.ToInt32(cmd.ExecuteScalar());
  Assert.AreEqual(<span class="code-digit">2</span>, count, <span class="code-string">"</span><span class="code-string">Expected 2 LatLon record."</span>);
  cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
  count = Convert.ToInt32(cmd.ExecuteScalar());
  Assert.AreEqual(<span class="code-digit">2</span>, count, <span class="code-string">"</span><span class="code-string">Expected 2 Restaurant records."</span>);

  sdr.Terminate();
}</pre>

<h4>Two-Level Unique Structure Insert Test</h4>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; Next, we want to see what happens when we create the LatLon structure, indicating that it is unique:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitRestaurantLatLonUniqueChildST()
{
  SemanticTypeStruct stsRest = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Restaurant"</span>, <span class="code-keyword">false</span>, decls, structs);
  SemanticTypeStruct stsLatLon = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>, decls, structs); <span class="code-comment">//</span><span class="code-comment"> child ST LatLon is declared to be unique.</span>
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateSemanticElement(stsRest, <span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>); <span class="code-comment">//</span><span class="code-comment"> The element LatLon in Restaurant is NOT unique.</span>
}</pre>

<p>As expected, when we attempt to insert two duplicate records, that LatLon structure is inserted only once and we get two Restaurant records pointing to the same LatLon record:</p>

<pre><span class="code-keyword">int</span> count;
IDbCommand cmd = conn.CreateCommand();
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 LatLon record."</span>);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 Restaurant record."</span>);

<span class="code-comment">//</span><span class="code-comment"> Insert another, identical record. We should still have one record.</span>
sdr.ProcessCarrier(carrier);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 LatLon record."</span>);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">2</span>, count, <span class="code-string">"</span><span class="code-string">Expected 2 Restaurant records."</span>);</pre>

<h4>Two-Level Unique Element Insert Test</h4>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; A variation on this theme is creating the Restaurant-LatLon structure such that the LatLon <i>element</i> of the Restaurant structure is declared unique.&nbsp; In concrete terms, this tells the semantic database that the foreign key field "fk_latlonid" is a unique field.&nbsp; We initialize the structure in code like this:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitRestaurantLatLonUniqueParentSTElement()
{
  SemanticTypeStruct stsRest = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Restaurant"</span>, <span class="code-keyword">false</span>, decls, structs);
  SemanticTypeStruct stsLatLon = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>, decls, structs); <span class="code-comment">//</span><span class="code-comment"> child ST LatLon is declared to NOT be unique.</span>
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateSemanticElement(stsRest, <span class="code-string">"</span><span class="code-string">LatLon"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>); <span class="code-comment">//</span><span class="code-comment"> The element LatLon in Restaurant is unique.</span>
}</pre>

<p>Here's our test (the earlier part of the test code is the same as in the previous cases):</p>

<pre><span class="code-keyword">int</span> count;
IDbCommand cmd = conn.CreateCommand();
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 LatLon record."</span>);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 Restaurant record."</span>);

<span class="code-comment">//</span><span class="code-comment"> Insert another, identical record. We should have two records.</span>
sdr.ProcessCarrier(carrier);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">2</span>, count, <span class="code-string">"</span><span class="code-string">Expected 2 LatLon records."</span>);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">2</span>, count, <span class="code-string">"</span><span class="code-string">Expected 2 Restaurant records."</span>);</pre>

<p>Because only the foreign key is unique, we will be inserting two LatLon records, as there are no fields declared unique in LatLon.&nbsp; Because this returns a new ID, the foreign key field is not unique, causing a second entry in the Restaurant table.</p>

<h4>Two-Level Unique Element <i>and Structure </i>Insert Test</h4>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; Finally, we test the combination where both the Restaurant's <i>element</i> LatLon (ie, it's foreign key) <i>and</i> the LatLon structure itself are unique.&nbsp; Here's how we configure the semantic structure:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitRestaurantUniqueLatLonAndParentSTElement()
{
  SemanticTypeStruct stsRest = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Restaurant"</span>, <span class="code-keyword">false</span>, decls, structs);
  SemanticTypeStruct stsLatLon = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>, decls, structs); 
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateSemanticElement(stsRest, <span class="code-string">"</span><span class="code-string">LatLon"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>); <span class="code-comment">//</span><span class="code-comment"> The element LatLon in Restaurant is unique.</span>
}</pre>

<p>Now we see that, because the structure LatLon is unique <i>and</i> the LatLon element in Restaurant is unique (implemented as the foreign key) we get one Restaurant record and one LatLon record when we attempt to insert two identical records:</p>

<pre><span class="code-keyword">int</span> count;
IDbCommand cmd = conn.CreateCommand();
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 LatLon record."</span>);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 Restaurant record."</span>);

<span class="code-comment">//</span><span class="code-comment"> Insert another, identical record. We should still have one record.</span>
sdr.ProcessCarrier(carrier);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from LatLon"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 LatLon record."</span>);
cmd.CommandText = <span class="code-string">"</span><span class="code-string">SELECT count(*) from Restaurant"</span>;
count = Convert.ToInt32(cmd.ExecuteScalar());
Assert.AreEqual(<span class="code-digit">1</span>, count, <span class="code-string">"</span><span class="code-string">Expected 1 Restaurant record."</span>);</pre>

<p><img border="0" height="64" src="/KB/recipes/832959/quiz.png" width="47"> Since this is all very complicated, let's test your comprehension.&nbsp; What happens when the semantic structure is declared like this:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitRestaurantUniqueLatLonAndParentSTElement()
{
  SemanticTypeStruct stsRest = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Restaurant"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>, decls, structs);
  SemanticTypeStruct stsLatLon = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">false</span>, decls, structs); 
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">latitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(stsLatLon, <span class="code-string">"</span><span class="code-string">longitude"</span>, <span class="code-string">"</span><span class="code-string">double"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateSemanticElement(stsRest, <span class="code-string">"</span><span class="code-string">LatLon"</span>, <span class="code-keyword">true</span>); <span class="code-comment">//</span><span class="code-comment"> The element LatLon in Restaurant is unique.</span>
}</pre>

<p>Yes indeed, because the Restaurant structure is itself declared as unique, every child element inherits its parent's uniqueness, and again we will insert only one actual record for two or more attempts of a duplicate semantic structure value.</p>

<h3>A Simple Query Test</h3>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14"> If you thought inserting data was complicated, getting it back out of the database is even more complicated because of the inferences that the semantic database makes regarding how to join to disparate semantic structures.&nbsp; Querying consists of:</p>

<ul>
	<li>Determining the native type fields</li>
	<li>Build the list of joins required to drill down into child elements</li>
	<li>Resolve physical table and field names in the order by clause</li>
	<li>Resolve physical table and field names in the where clause (currently not implemented)</li>
	<li>Add the database-specific implementation of a row return limit</li>
	<li>In a multi-structure join, infer the linkages between structures and implement them as additional table joins</li>
	<li>Execute the query</li>
	<li>Hydrate semantic instances with the data from each returned row</li>
</ul>

<p>Let's start with a basic single structure query:</p>

<pre><span class="code-bracket">[</span><span class="code-sdkkeyword">TestMethod<span class="code-none">]</span></span>
<span class="code-keyword">public</span> <span class="code-keyword">void</span> SimpleQuery()
{
  InitializeSDRTests(() =<span class="code-keyword">&gt;</span> InitLatLonNonUnique());

  <span class="code-comment">//</span><span class="code-comment"> Initialize the Semantic Data Receptor with the signal it should be listening to.</span>
  DropTable(<span class="code-string">"</span><span class="code-string">Restaurant"</span>); <span class="code-comment">//</span><span class="code-comment"> Dependent table we have to remove first.</span>
  DropTable(<span class="code-string">"</span><span class="code-string">LatLon"</span>);
  sdr.Protocols = <span class="code-string">"</span><span class="code-string">LatLon"</span>;
  sdr.ProtocolsUpdated();
  sdr.UnitTesting = <span class="code-keyword">true</span>;

  <span class="code-comment">//</span><span class="code-comment"> Create the signal.</span>
  ICarrier latLonCarrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">LatLon"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.latitude = <span class="code-digit">1</span>.<span class="code-digit">0</span>;
    signal.longitude = <span class="code-digit">2</span>.<span class="code-digit">0</span>;
  });

  sdr.ProcessCarrier(latLonCarrier);

  <span class="code-comment">//</span><span class="code-comment"> Create the query</span>
  ICarrier queryCarrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">Query"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.QueryText = <span class="code-string">"</span><span class="code-string">LatLon"</span>;
  });

  sdr.ProcessCarrier(queryCarrier);
  List&lt;QueuedCarrierAction&gt; queuedCarriers = rsys.QueuedCarriers;
  Assert.AreEqual(<span class="code-digit">1</span>, queuedCarriers.Count, <span class="code-string">"</span><span class="code-string">Expected one signal to be returned."</span>);
  <span class="code-keyword">dynamic</span> retSignal = queuedCarriers[0].Carrier.Signal;
  Assert.AreEqual(<span class="code-digit">1</span>.<span class="code-digit">0</span>, retSignal.latitude, <span class="code-string">"</span><span class="code-string">Wrong data for latitude."</span>);
  Assert.AreEqual(<span class="code-digit">2</span>.<span class="code-digit">0</span>, retSignal.longitude, <span class="code-string">"</span><span class="code-string">Wrong data for longitude."</span>);
}</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> Because we're using the HOPE architecture, there is actually no receiving carrier for the resulting record, so we inspect the queue, which is simpler than adding the necessary scaffolding in our unit tests to receive the carrier.</p>

<p><img border="0" height="32" src="/KB/recipes/832959/database.png" width="32"> The single-structure query implementation is basically what you would expect:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> QueryDatabase(<span class="code-keyword">string</span> query)
{
  <span class="code-keyword">string</span> maxRecords = <span class="code-keyword">null</span>;
  List&lt;string&gt; types;
  List&lt;string&gt; orderBy;

  Preprocess(query, <span class="code-keyword">out</span> maxRecords, <span class="code-keyword">out</span> types, <span class="code-keyword">out</span> orderBy);

  <span class="code-comment">//</span><span class="code-comment"> We only have one protocol to query, so we can create the protocol directly since it&#39;s already defined.</span>
  <span class="code-keyword">if</span> (types.Count() == <span class="code-digit">1</span>)
  {
    <span class="code-keyword">string</span> protocol = types[0];
    AddEmitProtocol(protocol); <span class="code-comment">//</span><span class="code-comment"> identical protocols are ignored.</span>
    ISemanticTypeStruct sts = rsys.SemanticTypeSystem.GetSemanticTypeStruct(protocol);
    List&lt;object&gt; signals = QueryType(protocol, <span class="code-sdkkeyword">String</span>.Empty, orderBy, maxRecords);
    EmitSignals(signals, sts);
  }
  <span class="code-keyword">else</span> ...</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> Again, because the semantic database is actually a receptor, any newly encountered protocol is added to the list of protocols that the database emits.&nbsp; Hence the line <code>AddEmitProtocol</code>.</p>

<p>The method <code>QueryType</code> puts all the pieces together to execute the query:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Return a list of objects that represents the semantic element instances (signals) in the resulting query set.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> List&lt;object&gt; QueryType(<span class="code-keyword">string</span> protocol, <span class="code-keyword">string</span> <span class="code-sdkkeyword">where</span>, List&lt;string&gt; orderBy, <span class="code-keyword">string</span> maxRecords)
{
  <span class="code-comment">//</span><span class="code-comment"> We build the query by recursing through the semantic structure.</span>
  ISemanticTypeStruct sts = rsys.SemanticTypeSystem.GetSemanticTypeStruct(protocol);
  List&lt;string&gt; fields = <span class="code-keyword">new</span> List&lt;string&gt;();
  List&lt;string&gt; joins = <span class="code-keyword">new</span> List&lt;string&gt;();
  Dictionary&lt;ISemanticTypeStruct, int&gt; structureUseCounts = <span class="code-keyword">new</span> Dictionary&lt;ISemanticTypeStruct, int&gt;();
  List&lt;Tuple&lt;string, string&gt;&gt; fqntAliases = <span class="code-keyword">new</span> List&lt;Tuple&lt;string, string&gt;&gt;();

  BuildQuery(sts, fields, joins, structureUseCounts, sts.DeclTypeName, fqntAliases);
  <span class="code-keyword">string</span> sqlQuery = CreateSqlStatement(sts, fields, joins, fqntAliases, <span class="code-sdkkeyword">where</span>, orderBy, maxRecords);

  List&lt;object&gt; ret = PopulateSignals(sqlQuery, sts);

  <span class="code-keyword">return</span> ret;
}</pre>

<p>Very important in this process is the recursive <code>BuildQuery</code>, which traverses the semantic structure, following child elements and creating the necessary joins as well as picking up any native types along the way:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Recurses the semantic structure to generate the native type fields and the semantic element joins.
</span><span class="code-summarycomment">///</span><span class="code-comment"> fqntAliases -- fully qualified native type and it&#39;s actual alias in the field list.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">void</span> BuildQuery(ISemanticTypeStruct sts, List&lt;string&gt; fields, List&lt;string&gt; joins, Dictionary&lt;ISemanticTypeStruct, int&gt; structureUseCounts, <span class="code-keyword">string</span> fqn, List&lt;Tuple&lt;string, string&gt;&gt; fqntAliases)
{
  <span class="code-comment">//</span><span class="code-comment"> Add native type fields.</span>
  <span class="code-keyword">string</span> parentName = GetUseName(sts, structureUseCounts);
  sts.NativeTypes.ForEach(nt =<span class="code-keyword">&gt;</span>
  {
    <span class="code-keyword">string</span> qualifiedFieldName = fqn + <span class="code-string">"</span><span class="code-string">."</span> + nt.Name;
    <span class="code-keyword">string</span> qualifiedAliasFieldName = parentName + <span class="code-string">"</span><span class="code-string">."</span> + nt.Name;
    fields.Add(qualifiedAliasFieldName);
    fqntAliases.Add(<span class="code-keyword">new</span> Tuple&lt;string, string&gt;(qualifiedFieldName, qualifiedAliasFieldName));
  });

  sts.SemanticElements.ForEach(child =<span class="code-keyword">&gt;</span>
  {
    ISemanticTypeStruct childsts = child.Element.Struct; <span class="code-comment">//</span><span class="code-comment"> rsys.SemanticTypeSystem.GetSemanticTypeStruct(child.Name);</span>
    IncrementUseCount(childsts, structureUseCounts);
    <span class="code-keyword">string</span> asChildName = GetUseName(childsts, structureUseCounts);
    joins.Add(<span class="code-string">"</span><span class="code-string">left join "</span> + childsts.DeclTypeName + <span class="code-string">"</span><span class="code-string"> as "</span> + asChildName + <span class="code-string">"</span><span class="code-string"> on "</span> + asChildName + <span class="code-string">"</span><span class="code-string">.ID = "</span> + parentName + <span class="code-string">"</span><span class="code-string">.FK_"</span> + childsts.DeclTypeName + <span class="code-string">"</span><span class="code-string">ID"</span>);
    BuildQuery(childsts, fields, joins, structureUseCounts, fqn+<span class="code-string">"</span><span class="code-string">."</span>+childsts.DeclTypeName, fqntAliases);
  });
}</pre>

<p>Once that's done, the actual SQL select statement can be created:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">string</span> CreateSqlStatement(ISemanticTypeStruct sts, List&lt;string&gt; fields, List&lt;string&gt; joins, List&lt;Tuple&lt;string, string&gt;&gt; fqntAliases, <span class="code-keyword">string</span> <span class="code-sdkkeyword">where</span>, List&lt;string&gt; orderBy, <span class="code-keyword">string</span> maxRecords)
{
  <span class="code-comment">//</span><span class="code-comment"> CRLF for pretty inspection.</span>
  <span class="code-keyword">string</span> sqlQuery = <span class="code-string">"</span><span class="code-string">select "</span> + <span class="code-sdkkeyword">String</span>.Join(<span class="code-string">"</span><span class="code-string">, "</span>, fields) + <span class="code-string">"</span><span class="code-string"> \r\nfrom "</span> + sts.DeclTypeName + <span class="code-string">"</span><span class="code-string"> \r\n"</span> + <span class="code-sdkkeyword">String</span>.Join(<span class="code-string">"</span><span class="code-string"> \r\n"</span>, joins);
  sqlQuery = sqlQuery + <span class="code-string">"</span><span class="code-string"> "</span> + ParseOrderBy(orderBy, fqntAliases);
  sqlQuery = dbio.AddLimitClause(sqlQuery, maxRecords);

  <span class="code-keyword">return</span> sqlQuery;
}</pre>

<p>Once we've acquired the reader, we can iterate through the records and create the signals to be emitted:</p>

<pre><span class="code-keyword">protected</span> List&lt;object&gt; PopulateSignals(<span class="code-keyword">string</span> sqlQuery, ISemanticTypeStruct sts)
{
  List&lt;object&gt; ret = <span class="code-keyword">new</span> List&lt;object&gt;();
  IDataReader reader = AcquireReader(sqlQuery);

  <span class="code-keyword">while</span> (reader.Read())
  {
    <span class="code-keyword">object</span> outsignal = rsys.SemanticTypeSystem.Create(sts.DeclTypeName);
    <span class="code-keyword">int</span> counter = <span class="code-digit">0</span>; <span class="code-comment">//</span><span class="code-comment"> For a single table join, counter is always 0.</span>
    <span class="code-comment">//</span><span class="code-comment"> Populate the signal with the columns in each record read.</span>
    Populate(sts, outsignal, reader, <span class="code-keyword">ref</span> counter);
    ret.Add(outsignal);
  }

  reader.Close();

  <span class="code-keyword">return</span> ret;
}</pre>

<p>The actual population of the signal's fields is again recursive and dependent upon the same order in which fields were generated for the query statement.&nbsp; Here we are using reflection to set the values as we drill into the semantic structure:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Recursively populates the values into the signal. The recursion algorithm here must match exactly the same
</span><span class="code-summarycomment">///</span><span class="code-comment"> form as the recursion algorithm in BuildQuery, as the correlation between field names and their occurrance
</span><span class="code-summarycomment">///</span><span class="code-comment"> in the semantic structure is relied upon. For now at least.
</span><span class="code-summarycomment">///</span><span class="code-comment"> Returns true if there are any non-null NT valus.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">bool</span> Populate(ISemanticTypeStruct sts, <span class="code-keyword">object</span> signal, IDataReader reader, <span class="code-keyword">ref</span> <span class="code-keyword">int</span> parmNumber)
{
  List&lt;object&gt; vals = <span class="code-keyword">new</span> List&lt;object&gt;();
  <span class="code-keyword">bool</span> anyNonNull = <span class="code-keyword">false</span>;

  <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> sts.NativeTypes.Count; i++)
  {
    vals.Add(reader[parmNumber++]);
  }

  <span class="code-comment">//</span><span class="code-comment"> Add native type fields. Use a foreach loop because ref types can&#39;t be used in lambda expressions.</span>
  sts.NativeTypes.ForEachWithIndex((nt, idx) =<span class="code-keyword">&gt;</span>
  {
    <span class="code-keyword">object</span> val = vals[idx];

    <span class="code-keyword">if</span> (val != DBNull.Value)
    {
      Assert.TryCatch(() =<span class="code-keyword">&gt;</span> nt.SetValue(rsys.SemanticTypeSystem, signal, val), (ex) =<span class="code-keyword">&gt;</span> EmitException(ex));
      anyNonNull = <span class="code-keyword">true</span>;
    }
  });

  <span class="code-keyword">foreach</span> (ISemanticElement child <span class="code-keyword">in</span> sts.SemanticElements)
  {
    ISemanticTypeStruct childsts = child.Element.Struct;
    PropertyInfo piSub = signal.GetType().GetProperty(child.Name);
    <span class="code-keyword">object</span> childSignal = piSub.GetValue(signal);
    anyNonNull |= Populate(childsts, childSignal, reader, <span class="code-keyword">ref</span> parmNumber);
  }

  <span class="code-keyword">return</span> anyNonNull;
}</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24">&nbsp; In the single structure query, we don't really care whether there are any non-null fields.&nbsp; The return value of the Populate method is however used when working with multi-structure queries, as all-null fields for a structure sets the structure to null.&nbsp; Also, <code>parmNumber</code> is again something that comes into play in a multi-structure query.</p>

<h3>Alias Query Test</h3>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14"> This test does a simple check that table and field name aliases are used.&nbsp; The semantic structure is set up as follows:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitPersonStruct()
{
  SemanticTypeStruct stsText = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Text"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateNativeType(stsText, <span class="code-string">"</span><span class="code-string">Value"</span>, <span class="code-string">"</span><span class="code-string">string"</span>, <span class="code-keyword">false</span>);

  SemanticTypeStruct stsFirstName = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">FirstName"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsFirstName, <span class="code-string">"</span><span class="code-string">Text"</span>, <span class="code-keyword">false</span>);

  SemanticTypeStruct stsLastName = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">LastName"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsLastName, <span class="code-string">"</span><span class="code-string">Text"</span>, <span class="code-keyword">false</span>);

  SemanticTypeStruct stsPerson = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Person"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsPerson, <span class="code-string">"</span><span class="code-string">LastName"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateSemanticElement(stsPerson, <span class="code-string">"</span><span class="code-string">FirstName"</span>, <span class="code-keyword">false</span>);
}</pre>

<p>Here, Person consists of FirstName and LastName, both of which reference the Text structure.&nbsp; This requires two joins to the Text table which means the table has to be aliased.&nbsp; The field name, being the same, must be aliased as well.&nbsp;</p>

<p><img border="0" height="32" src="/KB/recipes/832959/database.png" width="32"> In the semantic database, this is accomplished by keeping track of the table usage and incrementing a counter for each usage:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Append the use counter if it exists.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> <span class="code-keyword">string</span> GetUseName(ISemanticTypeStruct sts, Dictionary&lt;ISemanticTypeStruct, int&gt; structureUseCounts)
{
  <span class="code-keyword">int</span> count;
  <span class="code-keyword">string</span> ret = sts.DeclTypeName;

  <span class="code-keyword">if</span> (structureUseCounts.TryGetValue(sts, <span class="code-keyword">out</span> count))
  {
    ret = ret + count;
  }

  <span class="code-keyword">return</span> ret;
}</pre>

<p>The resulting query looks like this:</p>

<pre><span class="code-sdkkeyword">select</span> &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>Text1</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>.Value, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>Text2</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>.Value 
<span class="code-sdkkeyword">from</span> Person 
left <span class="code-sdkkeyword">join</span> LastName <span class="code-keyword">as</span> &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>LastName1</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span> on LastName1.ID = Person.FK_LastNameID 
left <span class="code-sdkkeyword">join</span> Text <span class="code-keyword">as</span> &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>Text1</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span> on Text1.ID = LastName1.FK_TextID 
left <span class="code-sdkkeyword">join</span> FirstName <span class="code-keyword">as</span> &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>FirstName1</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span> on FirstName1.ID = Person.FK_FirstNameID 
left <span class="code-sdkkeyword">join</span> Text <span class="code-keyword">as</span> &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>Text2</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span> on Text2.ID = FirstName1.FK_TextID </pre>

<p>Notice the "as" statements.&nbsp; For convenience, every table is aliased.&nbsp; This is essential for multi-structure joins.</p>

<h3>Unique Key Join</h3>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; There are three ways to join structures: by their unique key fields, the structure being declared unique, or by a structure's unique elements.&nbsp; The latter two resolve to unique key fields, but still requires testing (the test after this one.)&nbsp; Here, we test that a shared structure, which is declared as unique, allows the semantic database to infer that the two parent structures can be joined.&nbsp; The structures are defined like this:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitFeedUrlWithUniqueStruct()
{
  SemanticTypeStruct stsUrl = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Url"</span>, &lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>true</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>, decls, structs);
  Helpers.CreateNativeType(stsUrl, <span class="code-string">"</span><span class="code-string">Value"</span>, <span class="code-string">"</span><span class="code-string">string"</span>, <span class="code-keyword">false</span>);

  SemanticTypeStruct stsVisited = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Visited"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsVisited, <span class="code-string">"</span><span class="code-string">Url"</span>, <span class="code-keyword">false</span>);
  Helpers.CreateNativeType(stsVisited, <span class="code-string">"</span><span class="code-string">Count"</span>, <span class="code-string">"</span><span class="code-string">int"</span>, <span class="code-keyword">false</span>);

  SemanticTypeStruct stsFeedUrl = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsFeedUrl, <span class="code-string">"</span><span class="code-string">Url"</span>, <span class="code-keyword">false</span>);
}</pre>

<p>A common structure, Url, is created as being unique.&nbsp; Both the Visited and RSSFeedURl structures reference Url.&nbsp;</p>

<p>The unit test sets up two "feed" entries:</p>

<ul>
	<li><a href="http://localhost/">http://localhost</a></li>
	<li><a href="http://www.codeproject.com/">http://www.codeproject.com</a></li>
</ul>

<p>However, the visited only references <a href="http://localhost/"> http://localhost</a> (sorry Code Project!)</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> TwoStructureJoinTest()
{
  DropTable(<span class="code-string">"</span><span class="code-string">Url"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">Visited"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>);

  sdr.Protocols = <span class="code-string">"</span><span class="code-string">RSSFeedUrl; Visited"</span>;
  sdr.ProtocolsUpdated();
  sdr.UnitTesting = <span class="code-keyword">true</span>;

  <span class="code-comment">//</span><span class="code-comment"> The schema defines that:</span>
  <span class="code-comment">//</span><span class="code-comment"> URL is a unique structure</span>
  <span class="code-comment">//</span><span class="code-comment"> RSSFeedUrl.Url is unique (no duplicates pointing to the same Url)</span>
  <span class="code-comment">//</span><span class="code-comment"> Visited.Url is unique (no duplicates pointing to the same Url)</span>

  ICarrier feedUrlCarrier1 = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.Url.Value = <span class="code-string">"</span><span class="code-string">http://localhost"</span>;
  });

  <span class="code-comment">//</span><span class="code-comment"> A URL we will not be joining on because we don&#39;t have a Visited record.</span>
  ICarrier feedUrlCarrier2 = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.Url.Value = <span class="code-string">"</span><span class="code-string">http://www.codeproject.com"</span>;
  });

  ICarrier visitedCarrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">Visited"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.Url.Value = <span class="code-string">"</span><span class="code-string">http://localhost"</span>;
    signal.Count = <span class="code-digit">1</span>; <span class="code-comment">//</span><span class="code-comment"> non-zero value to make sure that we&#39;re not getting a default value back.</span>
  });

  sdr.ProcessCarrier(feedUrlCarrier1);
  sdr.ProcessCarrier(feedUrlCarrier2);
  sdr.ProcessCarrier(visitedCarrier);

  <span class="code-comment">//</span><span class="code-comment"> Create the query</span>
  ICarrier queryCarrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">Query"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    <span class="code-comment">//</span><span class="code-comment"> *** The order here is important, because the second join will be a left join ***</span>
    <span class="code-comment">//</span><span class="code-comment"> TODO: This needs to be exposed to the user somehow.</span>
    signal.QueryText = <span class="code-string">"</span><span class="code-string">RSSFeedUrl, Visited"</span>;
  });

  sdr.ProcessCarrier(queryCarrier);
  List&lt;QueuedCarrierAction&gt; queuedCarriers = rsys.QueuedCarriers;
  Assert.AreEqual(<span class="code-digit">2</span>, queuedCarriers.Count, <span class="code-string">"</span><span class="code-string">Expected two signals to be returned."</span>);

  <span class="code-comment">//</span><span class="code-comment"> The result, using a left join, is:</span>

  <span class="code-comment">//</span><span class="code-comment"> "http://localhost"; 1; "http://localhost"</span>
  <span class="code-comment">//</span><span class="code-comment"> "http://www.codeproject.com"; ; "" &lt;-- notice the Visited portion is null!</span>

  <span class="code-comment">//</span><span class="code-comment"> This is a new ST that isn&#39;t defined in our schema.</span>
  <span class="code-keyword">dynamic</span> retSignal = queuedCarriers[0].Carrier.Signal;
  Assert.AreEqual(<span class="code-string">"</span><span class="code-string">http://localhost"</span>, retSignal.RSSFeedUrl.Url.Value, <span class="code-string">"</span><span class="code-string">Unexpected URL value."</span>);
  Assert.AreEqual(<span class="code-digit">1</span>, retSignal.Visited.Count);

  retSignal = queuedCarriers[1].Carrier.Signal;
  Assert.AreEqual(<span class="code-string">"</span><span class="code-string">http://www.codeproject.com"</span>, retSignal.RSSFeedUrl.Url.Value, <span class="code-string">"</span><span class="code-string">Unexpected URL value."</span>);
  Assert.AreEqual(<span class="code-keyword">null</span>, retSignal.Visited);
}</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/database.png" width="32"> We see from the query how it is joining the two tables:</p>

<pre><span class="code-sdkkeyword">select</span> Url1.Value, Visited.Count, Url2.Value 
<span class="code-sdkkeyword">from</span> RSSFeedUrl 
left <span class="code-sdkkeyword">join</span> Url <span class="code-keyword">as</span> Url1 on Url1.ID = RSSFeedUrl.FK_UrlID 
left <span class="code-sdkkeyword">join</span> Visited on Visited.FK_UrlID = RSSFeedUrl.FK_UrlID 
left <span class="code-sdkkeyword">join</span> Url <span class="code-keyword">as</span> Url2 on Url2.ID = Visited.FK_UrlID </pre>

<p>And note how the data is returned:</p>

<p><img border="0" height="120" src="/KB/recipes/832959/query1.png" width="517"></p>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> The second row shows us the we do not have an associated Visited record for <a href="http://www.codeproject.com/">http://www.codeproject.com</a>.&nbsp; Because the Visited structure's fields are all null, the semantic database sets the instance to null, which is tested here:</p>

<pre>retSignal = queuedCarriers[1].Carrier.Signal;
Assert.AreEqual(<span class="code-string">"</span><span class="code-string">http://www.codeproject.com"</span>, retSignal.RSSFeedUrl.Url.Value, <span class="code-string">"</span><span class="code-string">Unexpected URL value."</span>);
&lt;font color=<span class="code-string">"</span><span class="code-string">#FF0000"</span>&gt;<b>Assert.AreEqual(<span class="code-keyword">null</span>, retSignal.Visited);</b><span class="code-keyword">&lt;/</span><span class="code-leadattribute">font</span><span class="code-keyword">&gt;</span>
</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> Also observe that the structure returned has been created at runtime by the semantic database.&nbsp; The returning signal consists of a root semantic type whose elements are the joined structures.&nbsp; Thus, in the above query, we get back the following structure:</p>

<p><img border="0" height="84" src="/KB/recipes/832959/query2.png" width="288"></p>

<p>Or, as I prefer to diagram semantic structures so that the native types are all at the top:</p>

<p><img border="0" height="216" src="/KB/recipes/832959/query3.png" width="288"></p>

<p><img border="0" height="32" src="/KB/recipes/832959/database.png" width="32"> What happens we try to join multiple semantic structures?</p>

<p>First, we need to discover the correct join order, such that tables are declared in the SQL join before they are referenced.&nbsp; While this is not a requirement for all database engines, I have noted that SQLite is definitely not happy if it sees a reference to table that hasn't been declared in a join yet.&nbsp; So, we can now begin walking through the code in this path:</p>

<pre><span class="code-keyword">else</span> <span class="code-keyword">if</span> (types.Count() <span class="code-keyword">&gt;</span> <span class="code-digit">1</span>)
{
  <span class="code-comment">//</span><span class="code-comment"> First we need to find common structures between each of the specified structures.</span>
  Dictionary&lt;string, List&lt;Tuple&lt;ISemanticTypeStruct, ISemanticTypeStruct&gt;&gt;&gt; stSemanticTypes = <span class="code-keyword">new</span> Dictionary&lt;string, List&lt;Tuple&lt;ISemanticTypeStruct, ISemanticTypeStruct&gt;&gt;&gt;();
  Dictionary&lt;TypeIntersection, List&lt;ISemanticTypeStruct&gt;&gt; typeIntersectionStructs = <span class="code-keyword">new</span> Dictionary&lt;TypeIntersection, List&lt;ISemanticTypeStruct&gt;&gt;();
  Dictionary&lt;ISemanticTypeStruct, int&gt; structureUseCounts = <span class="code-keyword">new</span> Dictionary&lt;ISemanticTypeStruct, int&gt;();

  List&lt;TypeIntersection&gt; joinOrder = DiscoverJoinOrder(types, stSemanticTypes, typeIntersectionStructs);
  ...</pre>

<p>DiscoverJoinOrder looks simple...</p>

<pre><span class="code-keyword">protected</span> List&lt;TypeIntersection&gt; DiscoverJoinOrder(List&lt;string&gt; types, Dictionary&lt;string, List&lt;Tuple&lt;ISemanticTypeStruct, ISemanticTypeStruct&gt;&gt;&gt; stSemanticTypes, Dictionary&lt;TypeIntersection, List&lt;ISemanticTypeStruct&gt;&gt; typeIntersectionStructs)
{
  <span class="code-comment">//</span><span class="code-comment"> For each root type, get all the sub-ST&#39;s.</span>
  <span class="code-keyword">foreach</span> (<span class="code-keyword">string</span> st <span class="code-keyword">in</span> types)
  {
    stSemanticTypes[st] = rsys.SemanticTypeSystem.GetAllSemanticTypes(st);
  }

  List&lt;TypeIntersection&gt; joinOrder = GetJoinOrder(types, stSemanticTypes, typeIntersectionStructs);

  <span class="code-keyword">return</span> joinOrder;
}</pre>

<p>... but it's deceptive, because the real work is in <code>GetJoinOrder</code>.&nbsp; This function is not very efficient, but it gets the job done for now.&nbsp; The concept is:</p>

<ol>
	<li>Starting with the first structure (the root structure), try and join it with some other following structure.</li>
	<li>Once we've found a shared structure, remove it from the list and start over again, trying to resolve the next structure in the join list.</li>
</ol>

<p>This process ensures that we create joins so that they are declared before being referenced by other joins:</p>

<pre><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-summarycomment">///</span><span class="code-comment"> Iterate until all joins are resolved.
</span><span class="code-summarycomment">///</span><span class="code-comment"> <span class="code-summarycomment">&lt;</span><span class="code-summarycomment">/summary</span><span class="code-summarycomment">&gt;</span>
</span><span class="code-keyword">protected</span> List&lt;TypeIntersection&gt; GetJoinOrder(List&lt;string&gt; types, Dictionary&lt;string, List&lt;Tuple&lt;ISemanticTypeStruct, ISemanticTypeStruct&gt;&gt;&gt; stSemanticTypes, Dictionary&lt;TypeIntersection, List&lt;ISemanticTypeStruct&gt;&gt; typeIntersectionStructs)
{
  <span class="code-comment">//</span><span class="code-comment"> We assume that the first ST is always the "base" ST, and everything else is joined to it or to other ST&#39;s.</span>
  <span class="code-comment">//</span><span class="code-comment"> This requires that we process joins 1..n in a specific order to ensure that joins to ST&#39;s are first defined, then referenced.</span>
  <span class="code-comment">//</span><span class="code-comment"> TODO: We do not have a test for that.</span>
  List&lt;TypeIntersection&gt; joinOrder = <span class="code-keyword">new</span> List&lt;TypeIntersection&gt;();
  List&lt;string&gt; typesToJoin = <span class="code-keyword">new</span> List&lt;string&gt;();

  <span class="code-comment">//</span><span class="code-comment"> We need to join all these types.</span>
  <span class="code-comment">//</span><span class="code-comment"> These may become "base" types if we have a dependency like:</span>
  <span class="code-comment">//</span><span class="code-comment"> 1 depends on 2, and 2 depends on 0.</span>
  <span class="code-comment">//</span><span class="code-comment"> To resolve 1, we first discover that 2 depends on 0</span>
  <span class="code-comment">//</span><span class="code-comment"> We then iterate again with 2 as the base type and discover that we can now join 1 as a dependency on 2.</span>
  <span class="code-comment">//</span><span class="code-comment"> The resulting order is then 0, 2, 1.</span>
  typesToJoin.AddRange(types.Skip(<span class="code-digit">1</span>));

  <span class="code-comment">//</span><span class="code-comment"> Assume idx 0 is the base.</span>
  <span class="code-keyword">int</span> baseIdx = <span class="code-digit">0</span>;

  <span class="code-comment">//</span><span class="code-comment"> Do we have any types left to join?</span>
  <span class="code-keyword">while</span> (typesToJoin.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>)
  {
    <span class="code-keyword">int</span> idx = <span class="code-digit">0</span>;
    <span class="code-keyword">bool</span> found = <span class="code-keyword">false</span>;

    <span class="code-comment">//</span><span class="code-comment"> Easier to debug if we don&#39;t use anonymous methods. Better for stack traces on exceptions too!</span>
    <span class="code-keyword">foreach</span> (<span class="code-keyword">string</span> typeToJoin <span class="code-keyword">in</span> types)
    {
      <span class="code-comment">//</span><span class="code-comment"> Skip any type that we already found a join for (it won&#39;t be in the list.)</span>
      <span class="code-keyword">if</span> (!typesToJoin.Contains(typeToJoin))
      {
        ++idx;
        <span class="code-keyword">continue</span>;
      }

      <span class="code-comment">//</span><span class="code-comment"> Returns a list of intersecting ST&#39;s between the base ST and another ST.</span>
      List&lt;ISemanticTypeStruct&gt; sharedStructs = stSemanticTypes[types[baseIdx]].Select(t1 =<span class="code-keyword">&gt;</span> t1.Item1).Intersect(stSemanticTypes[types[idx]].Select(t2 =<span class="code-keyword">&gt;</span> t2.Item1)).ToList();

      <span class="code-comment">//</span><span class="code-comment"> If we have shared structure...</span>
      <span class="code-keyword">if</span> (sharedStructs.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>)
      {
        <span class="code-comment">//</span><span class="code-comment"> TODO: We still need to verify that we have unique keys in which to accomplish a join.</span>
        <span class="code-comment">//</span><span class="code-comment"> Write a test for this.</span>
        <span class="code-comment">//</span><span class="code-comment"> (For now, we always assume that we do)</span>
        TypeIntersection typeIntersection = <span class="code-keyword">new</span> TypeIntersection(types[baseIdx], types[idx]);
        typeIntersectionStructs[typeIntersection] = sharedStructs;
        joinOrder.Add(typeIntersection);
        typesToJoin.Remove(types[idx]);
        found = <span class="code-keyword">true</span>;
        <span class="code-comment">//</span><span class="code-comment"> Try next type.</span>
        <span class="code-keyword">break</span>;
      }

      ++idx;
    }

    <span class="code-keyword">if</span> (found)
    {
      <span class="code-comment">//</span><span class="code-comment"> Start with the base again.</span>
      baseIdx = <span class="code-digit">0</span>;
    }
    <span class="code-keyword">else</span>
    {
      <span class="code-comment">//</span><span class="code-comment"> TODO: Determine what type failed to join so we can put out a more intelligent exception.</span>
      <span class="code-keyword">throw</span> <span class="code-keyword">new</span> Exception(<span class="code-string">"</span><span class="code-string">Cannot find a common type for the required join."</span>);
    }
  }

  <span class="code-keyword">return</span> joinOrder;
}</pre>

<p>We continue setting up various structures that will be used for constructing the full query and build the pieces for the first (root) semantic structure:</p>

<pre><span class="code-comment">//</span><span class="code-comment"> Since we always start with the first ST in the join list as the base type:</span>
List&lt;ISemanticTypeStruct&gt; sharedStructs = typeIntersectionStructs[joinOrder[0]];
ISemanticTypeStruct sharedStruct = sharedStructs[0];
<span class="code-keyword">string</span> baseType = joinOrder[0].BaseType;

ISemanticTypeStruct parent0 = stSemanticTypes[baseType].<span class="code-sdkkeyword">Single</span>(t =<span class="code-keyword">&gt;</span> t.Item1 == sharedStruct).Item2;
<span class="code-keyword">bool</span> parent0ElementUnique = parent0.SemanticElements.Any(se =<span class="code-keyword">&gt;</span> se.Name == sharedStruct.DeclTypeName &amp;&amp; se.UniqueField);

<span class="code-comment">//</span><span class="code-comment"> Build the query pieces for the first type:</span>
ISemanticTypeStruct sts0 = rsys.SemanticTypeSystem.GetSemanticTypeStruct(baseType);
List&lt;string&gt; fields0 = <span class="code-keyword">new</span> List&lt;string&gt;();
List&lt;string&gt; joins0 = <span class="code-keyword">new</span> List&lt;string&gt;();
List&lt;Tuple&lt;string, string&gt;&gt; fqntAliases = <span class="code-keyword">new</span> List&lt;Tuple&lt;string, string&gt;&gt;();

BuildQuery(sts0, fields0, joins0, structureUseCounts, sts0.DeclTypeName, fqntAliases);</pre>

<p>We now have the set of fields and required joins to populate those fields for the first structure.</p>

<p>We then iterate through the remaining structures, in the order determined earlier:</p>

<pre><span class="code-comment">//</span><span class="code-comment"> Now we&#39;re ready to join the other ST&#39;s, which are always joinOrder[joinIdx].JoinType.</span>
<span class="code-keyword">for</span> (<span class="code-keyword">int</span> joinIdx = <span class="code-digit">0</span>; joinIdx <span class="code-keyword">&lt;</span> joinOrder.Count; joinIdx++)
{
  <span class="code-keyword">string</span> joinType = joinOrder[joinIdx].JoinType;
  FixupBaseType(stSemanticTypes, sharedStruct, joinOrder, joinIdx, <span class="code-keyword">ref</span> baseType, <span class="code-keyword">ref</span> parent0, <span class="code-keyword">ref</span> parent0ElementUnique);</pre>

<p>It's necessary to always keep track of what structure we're joining to.&nbsp; If structure 0 is joined with structure 1, but structure 2 joins with structure 1, then we to update our "base" type so that it is now structure 1.&nbsp; This is what <code>FixupBaseType</code> does:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> FixupBaseType(Dictionary&lt;string, List&lt;Tuple&lt;ISemanticTypeStruct, ISemanticTypeStruct&gt;&gt;&gt; stSemanticTypes, ISemanticTypeStruct sharedStruct, List&lt;TypeIntersection&gt; joinOrder, <span class="code-keyword">int</span> joinIdx, <span class="code-keyword">ref</span> <span class="code-keyword">string</span> baseType, <span class="code-keyword">ref</span> ISemanticTypeStruct parent0, <span class="code-keyword">ref</span> <span class="code-keyword">bool</span> parent0ElementUnique)
{
  <span class="code-comment">//</span><span class="code-comment"> If we&#39;ve changed the "base" type, then update parent0 and parent0ElementUnique.</span>
  <span class="code-keyword">if</span> (joinOrder[joinIdx].BaseType != baseType)
  {
    baseType = joinOrder[joinIdx].BaseType;
    parent0 = stSemanticTypes[baseType].<span class="code-sdkkeyword">Single</span>(t =<span class="code-keyword">&gt;</span> t.Item1 == sharedStruct).Item2;
    parent0ElementUnique = parent0.SemanticElements.Any(se =<span class="code-keyword">&gt;</span> se.Name == sharedStruct.DeclTypeName &amp;&amp; se.UniqueField);
  }
}</pre>

<p>It ensures that the table we are "joining on" is the right-hand side of the join declaration.</p>

<p>Next, we obtain the shared structure between the "base" structure and the structure to which we're joining to.&nbsp; There's more code comments here than code:</p>

<pre>sharedStructs = typeIntersectionStructs[joinOrder[joinIdx]];

<span class="code-comment">//</span><span class="code-comment"> If the shared structure is a unique field in both parent structures, then we can do then join with the FK_ID&#39;s rather than the underlying data.</span>
<span class="code-comment">//</span><span class="code-comment"> So, for example, in the UniqueKeyJoinQuery unit test, we can join RSSFeedItem and Visited with:</span>
<span class="code-comment">//</span><span class="code-comment"> "join [one of the tables] on RSSFeedItem.FK_UrlID = Visited.FK_UrlID" (ignoring aliased table names)</span>
<span class="code-comment">//</span><span class="code-comment"> IMPORTANT: Where the parent tables in the "on" statement are the parents of the respective shared structure, not the root query structure name (which just so happens to be the same in this case.)</span>

<span class="code-comment">//</span><span class="code-comment"> If there is NOT a unique key at either or both ends, then we have to drill into all native types at the joined structure level for both query paths, which would look like:</span>
<span class="code-comment">//</span><span class="code-comment"> "join [one of the tables] on Url1.Value = Url2.Value [and...]" where the and aggregates all the NT values shared between the two query paths.</span>
<span class="code-comment">//</span><span class="code-comment"> Notice that here it is VITAL that we figure out the aliases for each query path.</span>

<span class="code-comment">//</span><span class="code-comment"> Interestingly, if both reference is unique structure, we get an intersection.</span>
<span class="code-comment">//</span><span class="code-comment"> If both reference a non-unique structure, we get an intersection, but then we need to check the parent to see if the element is unique for both paths.</span>

<span class="code-comment">//</span><span class="code-comment"> TODO: At the moment, we just pick the first shared structure. At some point we want to pick one that can work with FK&#39;s first, then NT unique key values if we can&#39;t find an FK join.</span>
<span class="code-comment">//</span><span class="code-comment"> TODO: If there&#39;s more than one shared structure, try an pick the one that is unique or who&#39;s parent is a unique element.</span>
<span class="code-comment">//</span><span class="code-comment"> TODO: Write a unit test for this.</span>
sharedStruct = sharedStructs[0];</pre>

<p>A shared structure requires that we obtain the parent structures which have a semantic element that matches the shared structure:</p>

<pre><span class="code-comment">//</span><span class="code-comment"> Find the parent for each root query given the shared structure.</span>
ISemanticTypeStruct parent1 = stSemanticTypes[joinType].<span class="code-sdkkeyword">Single</span>(t =<span class="code-keyword">&gt;</span> t.Item1 == sharedStruct).Item2;
<span class="code-keyword">bool</span> parent1ElementUnique = parent1.SemanticElements.Any(se =<span class="code-keyword">&gt;</span> se.Name == sharedStruct.DeclTypeName &amp;&amp; se.UniqueField);</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24"> Because we're always drilling into the entire semantic structure for a particular structure, this piece of code does something very deceptive -- it allows us to find the parent <i>anywhere </i>in the structure tree.&nbsp; This is very important, because we can join semantic structures "at the hip", as it were -- in other words, anywhere where the shared structure is encountered between the two semantic trees.</p>

<p>At this point we also have two important flags:</p>

<ul>
	<li>parent0ElementUnique</li>
	<li>parent1ElementUnique</li>
</ul>

<p>This is important because it informs the process that we can use foreign keys for the joins rather than native type unique fields.&nbsp; We see this test performed next:</p>

<pre><span class="code-comment">//</span><span class="code-comment"> If the shared structure is unique, or the elements referencing the structure are unique in both parents, then we can use the FK ID between the two parent ST&#39;s to join the structures.</span>
<span class="code-comment">//</span><span class="code-comment"> Otherwise, we have to use the NT values in each structure.</span>
<span class="code-keyword">if</span> ((sharedStruct.Unique) || (parent0ElementUnique &amp;&amp; parent1ElementUnique))
{
...</pre>

<p>If we know that the shared structure is declared unique, or that we have unique elements for both parents, we can use the foreign key values to join the two tables.&nbsp; First, we build up the fields and joins for table we are joining:</p>

<pre><span class="code-comment">//</span><span class="code-comment"> Build the query pieces for the second type, preserving counts so we don&#39;t accidentally re-use an alias.</span>
ISemanticTypeStruct sts1 = rsys.SemanticTypeSystem.GetSemanticTypeStruct(joinType);
List&lt;string&gt; fields1 = <span class="code-keyword">new</span> List&lt;string&gt;();
List&lt;string&gt; joins1 = <span class="code-keyword">new</span> List&lt;string&gt;();

BuildQuery(sts1, fields1, joins1, structureUseCounts, sts1.DeclTypeName, fqntAliases);
fields0.AddRange(fields1);</pre>

<p>Those fields are added to our "master" set of fields being queried.</p>

<p>Next, we construct the structure-structure join:</p>

<pre><span class="code-comment">//</span><span class="code-comment"> Note the root element of the second structure is always aliased as "1".</span>
<span class="code-comment">//</span><span class="code-comment"> TODO: This doesn&#39;t handle self joins. Scenario? Unit test? Test and throw exception?</span>
<span class="code-comment">//</span><span class="code-comment"> IMPORTANT: In Postgres, we note that the join that declares the table referenced in joins1 must be joined first.</span>
<span class="code-comment">//</span><span class="code-comment"> TODO: We use a left join here because we want to include records from the first table that may not match with the second table. This should be user definable, perhaps the way Oracle used to do it with the "+" to indicate a left join rather than an inner join.</span>
<span class="code-comment">//</span><span class="code-comment"> TODO: The root table name of the second table (parent1) doesn&#39;t need an "as" because it will only be referenced once (like in the "from" clause for parent0), however, this means </span>
<span class="code-comment">//</span><span class="code-comment"> that we can&#39;t join the same type twice. When will this be an issue?</span>

<span class="code-comment">//</span><span class="code-comment"> Except for types in the query itself, we need to aliased type.</span>
<span class="code-keyword">string</span> rightSideTableName = parent0.DeclTypeName;

<span class="code-keyword">if</span> (!types.Contains(parent0.DeclTypeName))
{
  rightSideTableName = parent0.DeclTypeName + <span class="code-string">"</span><span class="code-string">1"</span>; <span class="code-comment">//</span><span class="code-comment"> TODO: But do we need to know which alias, out of a possibility of aliases, to choose from???</span>
}

<span class="code-keyword">if</span> (sharedStruct.DeclTypeName == parent0.DeclTypeName)
{
  <span class="code-comment">//</span><span class="code-comment"> The right side should, in this case, be the ID, not an FK, as the left side is joining to the actual table rather than both referencing a common shared FK.</span>
  joins0.Add(<span class="code-string">"</span><span class="code-string">left join "</span> + parent1.DeclTypeName + <span class="code-string">"</span><span class="code-string"> on "</span> + parent1.DeclTypeName + <span class="code-string">"</span><span class="code-string">.FK_"</span> + sharedStruct.DeclTypeName + <span class="code-string">"</span><span class="code-string">ID = "</span> + rightSideTableName + <span class="code-string">"</span><span class="code-string">.ID"</span>);
}
<span class="code-keyword">else</span>
{
  joins0.Add(<span class="code-string">"</span><span class="code-string">left join "</span> + parent1.DeclTypeName + <span class="code-string">"</span><span class="code-string"> on "</span> + parent1.DeclTypeName + <span class="code-string">"</span><span class="code-string">.FK_"</span> + sharedStruct.DeclTypeName + <span class="code-string">"</span><span class="code-string">ID = "</span> + rightSideTableName + <span class="code-string">"</span><span class="code-string">.FK_"</span> + sharedStruct.DeclTypeName + <span class="code-string">"</span><span class="code-string">ID"</span>);
}

joins0.AddRange(joins1);</pre>

<p>And finally, we add the joins specific for the second structure -- these are joins for drilling into the structure, not for joining two structures together:</p>

<pre>joins0.AddRange(joins1);</pre>

<p>And amusingly, because I've not had to do this yet, joining by unique native types is not implemented:</p>

<pre><span class="code-keyword">else</span>
{
  <span class="code-comment">//</span><span class="code-comment"> TODO: Implement a join based on NT unique key values, as we&#39;re joining an ST with only NT&#39;s.</span>
  <span class="code-keyword">throw</span> <span class="code-keyword">new</span> Exception(<span class="code-string">"</span><span class="code-string">Non-FK joins are currently not supported."</span>);
}</pre>

<p>Finally, after all the table joins have been created, we finish the SQL statement and begin reading the results:</p>

<pre><span class="code-keyword">string</span> sqlQuery = <span class="code-string">"</span><span class="code-string">select "</span> + <span class="code-sdkkeyword">String</span>.Join(<span class="code-string">"</span><span class="code-string">, "</span>, fields0) + <span class="code-string">"</span><span class="code-string"> \r\nfrom "</span> + sts0.DeclTypeName + <span class="code-string">"</span><span class="code-string"> \r\n"</span> + <span class="code-sdkkeyword">String</span>.Join(<span class="code-string">"</span><span class="code-string"> \r\n"</span>, joins0);
sqlQuery = sqlQuery + <span class="code-string">"</span><span class="code-string"> "</span> + ParseOrderBy(orderBy, fqntAliases);
sqlQuery = dbio.AddLimitClause(sqlQuery, maxRecords);

ReadResults(sqlQuery);</pre>

<p>We read the root structure and all the joined structures, building the resulting new semantic structure culminating (finally!) in emitting a carrier with the custom protocol and the signal:</p>

<pre><span class="code-keyword">while</span> (reader.Read())
{
  <span class="code-keyword">int</span> counter = <span class="code-digit">0</span>;
  List&lt;object&gt; joinSignals = <span class="code-keyword">new</span> List&lt;object&gt;();

  <span class="code-comment">//</span><span class="code-comment"> The resulting fields are in the order of how they&#39;re populated based on our join list.</span>
  <span class="code-keyword">object</span> outsignal0 = PopulateStructure(types[0], reader, <span class="code-keyword">ref</span> counter);
  PopulateJoinStructures(joinSignals, joinOrder, reader, <span class="code-keyword">ref</span> counter);

  <span class="code-comment">//</span><span class="code-comment"> Now create a custom type if it doesn&#39;t already exist. The custom type name is formed from the type names in the join.</span>
  ISemanticTypeStruct outprotocol;
  <span class="code-keyword">object</span> outsignal = CreateCustomType(types, <span class="code-keyword">out</span> outprotocol);

  <span class="code-comment">//</span><span class="code-comment"> Assign our signals to the children of the custom type. </span>
  <span class="code-comment">//</span><span class="code-comment"> TODO: Again, self-joins will fail here.</span>
  SetValue(outsignal, types[0], outsignal0);
  SetJoinedSignals(outsignal, joinOrder, joinSignals);

  <span class="code-comment">//</span><span class="code-comment"> Finally! Create the carrier:</span>
  rsys.CreateCarrier(<span class="code-keyword">this</span>, outprotocol, outsignal);
}</pre>

<p><img border="0" height="32" src="/KB/recipes/832959/note.png" width="24">&nbsp; Note that this creates a carrier for each row.&nbsp; Implementing a collection of protocol-signals that can be placed onto a single carrier is on the todo list.</p>

<h3>Three Structure Join Test</h3>

<p><img border="0" height="32" src="/KB/recipes/832959/unittest.png" width="14">&nbsp; This all becomes more interesting when testing, for example, a three structure join, set up like this:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> InitFeedUrlWithUniqueElements()
{
  SemanticTypeStruct stsUrl = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Url"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateNativeType(stsUrl, <span class="code-string">"</span><span class="code-string">Value"</span>, <span class="code-string">"</span><span class="code-string">string"</span>, <span class="code-keyword">true</span>);

  SemanticTypeStruct stsVisited = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Visited"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsVisited, <span class="code-string">"</span><span class="code-string">Url"</span>, <span class="code-keyword">true</span>);
  Helpers.CreateNativeType(stsVisited, <span class="code-string">"</span><span class="code-string">Count"</span>, <span class="code-string">"</span><span class="code-string">int"</span>, <span class="code-keyword">false</span>);

  <span class="code-comment">//</span><span class="code-comment"> For 3 ST join tests.</span>
  SemanticTypeStruct stsDisplayed = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">Displayed"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsDisplayed, <span class="code-string">"</span><span class="code-string">Url"</span>, <span class="code-keyword">true</span>);

  SemanticTypeStruct stsFeedUrl = Helpers.CreateSemanticType(<span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>, <span class="code-keyword">false</span>, decls, structs);
  Helpers.CreateSemanticElement(stsFeedUrl, <span class="code-string">"</span><span class="code-string">Url"</span>, <span class="code-keyword">true</span>);
}</pre>

<p>This test sets up four structures: Url, Visited, Displayed, and RSSFeedUrl:</p>

<pre><span class="code-keyword">protected</span> <span class="code-keyword">void</span> ThreeSemanticTypesJoinTest()
{
  DropTable(<span class="code-string">"</span><span class="code-string">Url"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">Visited"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">Displayed"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>);
  DropTable(<span class="code-string">"</span><span class="code-string">RSSFeedItemDisplayed"</span>);

  sdr.Protocols = <span class="code-string">"</span><span class="code-string">RSSFeedUrl; Visited; Displayed"</span>;
  sdr.ProtocolsUpdated();
  sdr.UnitTesting = <span class="code-keyword">true</span>;

  <span class="code-comment">//</span><span class="code-comment"> The schema defines that:</span>
  <span class="code-comment">//</span><span class="code-comment"> URL is a unique structure</span>
  <span class="code-comment">//</span><span class="code-comment"> RSSFeedUrl.Url is unique (no duplicates pointing to the same Url)</span>
  <span class="code-comment">//</span><span class="code-comment"> Visited.Url is unique (no duplicates pointing to the same Url)</span>

  ICarrier feedUrlCarrier1 = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.Url.Value = <span class="code-string">"</span><span class="code-string">http://localhost"</span>;
  });

  <span class="code-comment">//</span><span class="code-comment"> A URL we will not be joining on because we don&#39;t have a Visited record.</span>
  ICarrier feedUrlCarrier2 = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">RSSFeedUrl"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.Url.Value = <span class="code-string">"</span><span class="code-string">http://www.codeproject.com"</span>;
  });

  ICarrier visitedCarrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">Visited"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.Url.Value = <span class="code-string">"</span><span class="code-string">http://localhost"</span>;
    signal.Count = <span class="code-digit">1</span>; <span class="code-comment">//</span><span class="code-comment"> non-zero value to make sure that we&#39;re not getting a default value back.</span>
  });

  ICarrier displayedCarrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">Displayed"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    signal.Url.Value = <span class="code-string">"</span><span class="code-string">http://www.codeproject.com"</span>;
  });

  sdr.ProcessCarrier(feedUrlCarrier1);
  sdr.ProcessCarrier(feedUrlCarrier2);
  sdr.ProcessCarrier(visitedCarrier);
  sdr.ProcessCarrier(displayedCarrier);

  <span class="code-comment">//</span><span class="code-comment"> Create the query</span>
  ICarrier queryCarrier = Helpers.CreateCarrier(rsys, <span class="code-string">"</span><span class="code-string">Query"</span>, signal =<span class="code-keyword">&gt;</span>
  {
    <span class="code-comment">//</span><span class="code-comment"> *** The order here is important, because the second join will be a left join ***</span>
    <span class="code-comment">//</span><span class="code-comment"> TODO: This needs to be exposed to the user somehow.</span>
    signal.QueryText = <span class="code-string">"</span><span class="code-string">RSSFeedUrl, Visited, Displayed"</span>;
  });

  sdr.ProcessCarrier(queryCarrier);
  List&lt;QueuedCarrierAction&gt; queuedCarriers = rsys.QueuedCarriers;
  Assert.AreEqual(<span class="code-digit">2</span>, queuedCarriers.Count, <span class="code-string">"</span><span class="code-string">Expected two signals to be returned."</span>);

  <span class="code-comment">//</span><span class="code-comment"> The result, using a left join, is:</span>

  <span class="code-comment">//</span><span class="code-comment"> "http://localhost"; 1; "http://localhost"</span>
  <span class="code-comment">//</span><span class="code-comment"> "http://www.codeproject.com"; ; "" &lt;-- notice the Visited portion is null, however the "displayed" portion is NOT null.</span>

  <span class="code-comment">//</span><span class="code-comment"> This is a new ST that isn&#39;t defined in our schema.</span>
  <span class="code-keyword">dynamic</span> retSignal = queuedCarriers[0].Carrier.Signal;
  Assert.AreEqual(<span class="code-string">"</span><span class="code-string">http://localhost"</span>, retSignal.RSSFeedUrl.Url.Value, <span class="code-string">"</span><span class="code-string">Unexpected URL value."</span>);
  Assert.AreEqual(<span class="code-digit">1</span>, retSignal.Visited.Count);
  Assert.AreEqual(<span class="code-keyword">null</span>, retSignal.Displayed);

  retSignal = queuedCarriers[1].Carrier.Signal;
  Assert.AreEqual(<span class="code-string">"</span><span class="code-string">http://www.codeproject.com"</span>, retSignal.RSSFeedUrl.Url.Value, <span class="code-string">"</span><span class="code-string">Unexpected URL value."</span>);
  Assert.AreEqual(<span class="code-keyword">null</span>, retSignal.Visited);
  Assert.AreNotEqual(<span class="code-keyword">null</span>, retSignal.Displayed);
}  </pre>

<p>The resulting query looks like this:</p>

<pre><span class="code-sdkkeyword">select</span> Url1.Value, Visited.Count, Url2.Value, Url3.Value 
<span class="code-sdkkeyword">from</span> RSSFeedUrl 
left <span class="code-sdkkeyword">join</span> Url <span class="code-keyword">as</span> Url1 on Url1.ID = RSSFeedUrl.FK_UrlID 
left <span class="code-sdkkeyword">join</span> Visited on Visited.FK_UrlID = RSSFeedUrl.FK_UrlID 
left <span class="code-sdkkeyword">join</span> Url <span class="code-keyword">as</span> Url2 on Url2.ID = Visited.FK_UrlID 
left <span class="code-sdkkeyword">join</span> Displayed on Displayed.FK_UrlID = RSSFeedUrl.FK_UrlID 
left <span class="code-sdkkeyword">join</span> Url <span class="code-keyword">as</span> Url3 on Url3.ID = Displayed.FK_UrlID </pre>

<p>with the data being returned looking like this:</p>

<p><img border="0" height="119" src="/KB/recipes/832959/query4.png" width="650"></p>

<h2>To Be Continued...</h2>

<p>While there are several important todo's in the code, we have a sufficient implementation to actually do something useful.&nbsp; In a <a href="http://www.codeproject.com/Articles/797457/The-Semantic-Web-and-Natural-Language-Processing"> previous article</a>, I explored RSS Feeds in relationship to natural language processing.&nbsp; In the next article, we'll use the semantic database to put together a feed reader application that includes persistence of "visited" and "displayed" states.&nbsp; We'll look at:</p>

<ul>
	<li>the semantic structures to support the application</li>
	<li>the receptors used</li>
	<li>how to add diagnostics while building HOPE applets</li>
	<li>viewing the SQL generated by the database engine</li>
	<li>discover how amazing it is to work in an environment where <i>persistence is a component.</i></li>
</ul>

<p>As a teaser, here's a screenshot of the applet, processing five different "tech" feeds, displaying recent feeds, visited feeds, and with bookmark capability:</p>

<p align="center"><img border="0" height="367" src="/KB/recipes/832959/query5.png" width="689"></p>

<p align="center"><img border="0" height="287" src="/KB/recipes/832959/query6.png" width="606"></p>

<h2>References</h2>

<p>1 - Semantic Data - <a href="http://en.wikipedia.org/wiki/Semantic_data_model"> http://en.wikipedia.org/wiki/Semantic_data_modell</a><br>
2 - Semantic Web - <a href="http://en.wikipedia.org/wiki/Semantic_Web"> http://en.wikipedia.org/wiki/Semantic_Web</a><br>
3 - Web Ontology Language - <a href="http://en.wikipedia.org/wiki/Web_Ontology_Language"> http://en.wikipedia.org/wiki/Web_Ontology_Language</a><br>
4 - Resource Description Format - <a href="http://en.wikipedia.org/wiki/Resource_Description_Framework"> http://en.wikipedia.org/wiki/Resource_Description_Framework</a><br>
5 - schema.org - <a href="http://www.schema.org/">schema.org</a><br>
6 - Semantics - <a href="http://en.wikipedia.org/wiki/Semantics"> http://en.wikipedia.org/wiki/Semantics</a><br>
7 - Tim Berners-Lee - <a href="http://en.wikipedia.org/wiki/Tim_Berners-Lee"> http://en.wikipedia.org/wiki/Tim_Berners-Lee</a><br>
8 - Semantics - <a href="http://en.wikipedia.org/wiki/Semantics"> http://en.wikipedia.org/wiki/Semantics</a><br>
9 - Ontology - <a href="http://en.wikipedia.org/wiki/Ontology_(information_science)">Ontology (information science)</a><br>
10 - Friend of a Friend - <a href="http://www.foaf-project.org/"> Friend of a Friend</a><br>
11 - W3C SKOS Core Guild - <a href="http://www.w3.org/TR/2005/WD-swbp-skos-core-guide-20051102/">W3C SKOS Core Guide</a><br>
12 - RDF Schema - <a href="http://en.wikipedia.org/wiki/RDF_Schema"> http://en.wikipedia.org/wiki/RDF_Schema</a><br>
13 - Neo4j - <a href="http://neo4j.com/blog/and-now-for-something-completely-different-using-owl-with-neo4j/"> http://neo4j.com/</a><br>
14 - Cypher - <a href="http://docs.neo4j.org/chunked/snapshot/cypher-query-lang.html">Cypher</a></p>

<p>&nbsp;</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Data-Structures"  data-loadOnView='true'  data-tags='C#, .NET, database, Web, SQLite, PostgreSQL, RDF, NoSQL, OWL, Graph,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=300x250&c=950477"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=300x250&c=950477"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

                        
						<h2>Share</h2>
				        <div class="share-list">
					        



<!-- Buttons start here. Copy this ul to your document. -->
<ul class="rrssb-buttons clearfix">
    <li class="email">

        <a href="mailto:?subject=Semantic%20Database%3a%20Concept%2c%20Architecture%20and%20Implementation%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme%0a">
            <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                    version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" 
                    enable-background="new 0 0 28 28" xml:space="preserve"><g>
                        <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                            c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                            9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                            0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                            7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                            0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                            26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                            1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"/></g>
                </svg>
            </span>
            <span class="text">email</span>
        </a>
    </li>
    <li class="twitter">
        <!-- Replace href with your Meta and URL information  -->
        <a href="http://twitter.com/home?status=Semantic+Database%3a+Concept%2c+Architecture+and+Implementation+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                    x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                    c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                    C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                    C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                    c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                    C26.275,7.229,25.39,8.196,24.253,8.756z"/>
                </svg>
            </span>
            <span class="text">twitter</span>
        </a>
    </li>

    <li class="facebook">
        <!-- Replace with your URL. For best results, make sure you page has the proper FB Open Graph tags in header: 
        https://developers.facebook.com/docs/opengraph/howtos/maximizing-distribution-media-content/ -->
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                    x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                        c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                        c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"/>
                </svg>
            </span>
            <span class="text">facebook</span>
        </a>
    </li>
    
    <li class="linkedin">
        <!-- Replace href with your meta and URL information -->
        <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme&amp;title=Semantic+Database%3a+Concept%2c+Architecture+and+Implementation+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                    x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                        c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                        h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                        c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                        C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"/>
                </svg>
            </span>
            <span class="text">linkedin</span>
        </a>
    </li>
    <li class="reddit">
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme&amp;title=Semantic+Database%3a+Concept%2c+Architecture+and+Implementation+-+CodeProject">
            <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" 
                    x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" 
                    enable-background="new 0 0 28 28" xml:space="preserve"><g>
                <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"/>
                <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"/>
                <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                19.5 17.8 19.5 17.5 19.791z"/><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                C26.354 13.8 26.1 14.3 25.8 14.605z"/></g></svg>
            </span>
            <span class="text">reddit</span>
        </a>
    </li>
    <li class="googleplus">
        <!-- Replace href with your meta and URL information.  -->
        <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                    x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <g>
                        <g>
                            <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663
                                c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027
                                C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068
                                c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562
                                c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41
                                c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511
                                c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478
                                c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492
                                c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479
                                c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"/>
                            <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004
                                23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89      "/>
                        </g>
                    </g>
                </svg>
            </span>
            <span class="text">google+</span>
        </a>
    </li>
    
</ul>
<!-- Buttons end here -->

				        </div> 
    			        


						
						<h2 id="ctl00_AboutHeading">About the Author</h2>
						    


<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="https://www.codeproject.com/script/Membership/ProfileImages/{CCCA6270-7875-4937-96C2-0CF123E2F30F}.jpg" style="border-width:0px;transform:rotate(0deg);" />

    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/Marc-Clifton">Marc Clifton</a></b>

        <table class="extended">
        <tr>
            <td rowspan="2" nowrap valign="middle">
            
            </td>
            <td width="100%">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United States <img src="/script/Geo/Images/US.gif" alt="United States" width="16px" height="11px" /></span>
            </td>
        </tr>
        </table>
    </div>

    <div class="description">
        Marc is the creator of two open source projects, <a rel="nofollow" href="http://www.myxaml.com/">MyXaml</a>, a declarative (XML) instantiation engine and <a rel="nofollow" href="http://www.marcclifton.com/Projects/AdvancedUnitTesting/tabid/102/Default.aspx"> the Advanced Unit Testing framework</a>, and <a rel="nofollow" href="http://www.interacx.com/">Interacx</a>, a commercial n-tier RAD application suite.&nbsp; Visit his website, <a rel="nofollow" href="http://www.marcclifton.com/">www.marcclifton.com</a>, where you will find many of his articles and his <a rel="nofollow" href="http://marcclifton.wordpress.com/">blog.</a><br />
<br />
Marc lives in Philmont, NY.

        
    </div>

</div><br />
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Data-Structures"  data-loadOnView='true'  data-tags='C#, .NET, database, Web, SQLite, PostgreSQL, RDF, NoSQL, OWL, Graph,rating4.5,pos_bottom'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=728x90&c=950477"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=728x90&c=950477"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				

                
        <h2 id="ctl00_AlsoRead_RelatedResults_ctl00_Header" class="also-read">You may also be interested in...</h2>
        <table class="spaced content-list also-read">
    
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl01_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl01_Thumbnail" href="https://www.codeproject.com/ResearchLibrary/261/Public-Private-and-Hybrid-Cloud-Whats-the-differen"><img src="https://www.codeproject.com/script/ResearchLibrary/Logos/LibraryItemThumbnail_261_100x130.png" alt="" style="border-width:0px;" /></a>
            <div class="pro-badge">Pro</div></div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl01_Link" href="https://www.codeproject.com/ResearchLibrary/261/Public-Private-and-Hybrid-Cloud-Whats-the-differen">Public, Private, and Hybrid Cloud: What's the difference?</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl02_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl02_Thumbnail" href="//www.codeproject.com/Articles/23/SAPrefs-Netscape-like-Preferences-Dialog"><img src="/KB/tabs/saprefs/Thumb-23.gif" alt="" style="border-width:0px;" /></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl02_Link" href="//www.codeproject.com/Articles/23/SAPrefs-Netscape-like-Preferences-Dialog">SAPrefs - Netscape-like Preferences Dialog</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl03_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl03_Thumbnail" href="//www.codeproject.com/Articles/1078330/Using-MongoDB-to-Implement-a-Semantic-Database-Par"><img src="/KB/NoSQL/1078330/Thumb-1078330.png" alt="" style="border-width:0px;" /></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl03_Link" href="//www.codeproject.com/Articles/1078330/Using-MongoDB-to-Implement-a-Semantic-Database-Par">Using MongoDB to Implement a Semantic Database - Part I</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl04_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl04_Thumbnail" href="//www.codeproject.com/Articles/47864/Generate-and-add-keyword-variations-using-AdWords"><img src="/KB/IP/AdWordsKeywordGenerator/Thumb-47864.png" alt="" style="border-width:0px;" /></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl04_Link" href="//www.codeproject.com/Articles/47864/Generate-and-add-keyword-variations-using-AdWords">Generate and add keyword variations using AdWords API</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl05_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl05_Thumbnail" href="//www.codeproject.com/Articles/797457/The-Semantic-Web-and-Natural-Language-Processing"><img src="/KB/cs/797457/Thumb-797457.png" alt="" style="border-width:0px;" /></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl05_Link" href="//www.codeproject.com/Articles/797457/The-Semantic-Web-and-Natural-Language-Processing">The Semantic Web and Natural Language Processing</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl06_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl06_Thumbnail" href="//www.codeproject.com/Articles/107/Window-Tabs-WndTabs-Add-In-for-DevStudio"><img src="/KB/macros/wndtabs/Thumb-107.jpg" alt="" style="border-width:0px;" /></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl06_Link" href="//www.codeproject.com/Articles/107/Window-Tabs-WndTabs-Add-In-for-DevStudio">Window Tabs (WndTabs) Add-In for DevStudio</a></div>
                
            </div>
        </td>
	    </tr>
	
		</table>
	



				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumControl49324533.SwitchMessage(event, null)">
<table id="ForumTable" class="forum tight" cellpadding="0" cellspacing="0">
<tr>
<td class="header1 callout"><b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme%3ffid%3d1871532%26df%3d90%26mpp%3d25%26prof%3dTrue%26sort%3dPosition%26view%3dThread%26spc%3dTight">Sign In</a> to use this message board.</b></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1871532" /><input type="hidden" name="sbo" value="fm" /><b>Search Comments </b><input type="search" class="search" name="qf" />&nbsp;<input type="submit" value="Go" class="button" />
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?fid=1871532&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Thread&amp;spc=Tight&amp;floc=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1871532" /><input type="hidden" name="currentQS" value="fid=1871532&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Thread&amp;spc=Tight&amp;floc=%2fArticles%2f832959%2fSemantic-Database-Concept-Architecture-and-Impleme" /><input type="hidden" name="floc" value="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme" />Spacing<select size="1" class="dropdown" name="spc">
<option value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option selected value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option selected value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button" />
</form>
</div></td>
</tr>
</table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tr>
<td><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt="" /></td>
</tr><tr id="F5268483_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5268483xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="5268483" parent="0" thread="5268483" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Thread&amp;spc=Tight&amp;select=5268483#xx5268483xx">My vote of 5</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author"><b class="button safe">D V L</b></span><span class="date">1-Jul-16  7:18</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5466984"><b class="button safe">D V L</b></a></span></td><td class="date"><span>1-Jul-16  7:18&nbsp;</span></td><td class="count">1&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F5268483_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5466984" msgid="5268483" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Excellent Article <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /><br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/5268483/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF5268483" data-ref="3_5268483" class="rating-label" name="RateItem_5268483" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5219814_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5219814xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="5219814" parent="0" thread="5219814" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Thread&amp;spc=Tight&amp;select=5219814#xx5219814xx">My vote of 5</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">johannesnestler</span><span class="date">22-Mar-16  7:36</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2677606">johannesnestler</a></span></td><td class="date"><span>22-Mar-16  7:36&nbsp;</span></td><td class="count">1&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F5219814_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2677606" msgid="5219814" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">outstanding presentation, interesting information and code - thank you!<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/5219814/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF5219814" data-ref="3_5219814" class="rating-label" name="RateItem_5219814" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4964504_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4964504xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4964504" parent="0" thread="4964504" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Thread&amp;spc=Tight&amp;select=4964504#xx4964504xx">My vote of 5</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">BillWoodruff</span><span class="date">16-Dec-14  6:26</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=26923">BillWoodruff</a></span></td><td class="date"><span>16-Dec-14  6:26&nbsp;</span></td><td class="count">1&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F4964504_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="26923" msgid="4964504" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Another remarkable article from a true visionary: so much to learn in the depths of thought and concepts here: bravo !<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/4964504/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4964504" data-ref="3_4964504" class="rating-label" name="RateItem_4964504" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4961371_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4961371xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4961371" parent="0" thread="4961371" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Thread&amp;spc=Tight&amp;select=4961371#xx4961371xx">My vote of 5</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">linuxjr</span><span class="date">11-Dec-14  3:17</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=76401">linuxjr</a></span></td><td class="date"><span>11-Dec-14  3:17&nbsp;</span></td><td class="count">2&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F4961371_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="76401" msgid="4961371" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Awesome article. Thank you for sharing your hard work.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;tid=4961371" title="View&nbsp;Thread"><b>View the reply to this message</b></a><br /><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/4961371/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4961371" data-ref="3_4961371" class="rating-label" name="RateItem_4961371" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4950347_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4950347xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4950347" parent="0" thread="4950347" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;select=4950347&amp;prof=True&amp;view=Thread#xx4950347xx">Agreed a 5 Doesn't Do this Justice</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">John Willson</span><span class="date">24-Nov-14  9:03</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5504612">John Willson</a></span></td><td class="date"><span>24-Nov-14  9:03&nbsp;</span></td><td class="count">2&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F4950347_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5504612" msgid="4950347" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I have been playing with these concepts for many years now and this is the best code based explanation I have read.  Thank-you!<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;tid=4950347" title="View&nbsp;Thread"><b>View the reply to this message</b></a><br /><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/4950347/Agreed-a-Doesnt-Do-this-Justice.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4950347" data-ref="3_4950347" class="rating-label" name="RateItem_4950347" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4950249_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4950249xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4950249" parent="0" thread="4950249" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;select=4950249&amp;prof=True&amp;view=Thread#xx4950249xx">Waw</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Luc Pattyn</span><span class="date">24-Nov-14  7:17</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-sitebuilder-16.gif" title="sitebuilder" alt="sitebuilder" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=648011">Luc Pattyn</a></span></td><td class="date"><span>24-Nov-14  7:17&nbsp;</span></td><td class="count">2&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F4950249_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="648011" msgid="4950249" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Extraordinary article.<br />
A 5 doesn't do it justice.<br />
<br />
<img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:" />  <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /> <br />
<div class="signature">Luc Pattyn <a href="http://www.perceler.com/articles1.php">[My Articles]</a> Nil Volentibus Arduum</div><br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;tid=4950249" title="View&nbsp;Thread"><b>View the reply to this message</b></a><br /><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/4950249/Waw.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4950249" data-ref="3_4950249" class="rating-label" name="RateItem_4950249" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4944065_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4944065xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4944065" parent="0" thread="4944065" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;select=4944065&amp;prof=True&amp;view=Thread#xx4944065xx">My vote of 5</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Agent__007</span><span class="date">13-Nov-14  17:04</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=7389346">Agent__007</a></span></td><td class="date"><span>13-Nov-14  17:04&nbsp;</span></td><td class="count">2&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F4944065_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7389346" msgid="4944065" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Another great one from a legend!<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;tid=4944065" title="View&nbsp;Thread"><b>View the reply to this message</b></a><br /><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/4944065/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4944065" data-ref="3_4944065" class="rating-label" name="RateItem_4944065" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4940454_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4940454xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4940454" parent="0" thread="4940454" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;select=4940454&amp;prof=True&amp;view=Thread#xx4940454xx">My vote of 5</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Raul Iloc</span><span class="date">9-Nov-14  22:08</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-MVP-16.gif" title="mvp" alt="mvp" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=307616">Raul Iloc</a></span></td><td class="date"><span>9-Nov-14  22:08&nbsp;</span></td><td class="count">2&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F4940454_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="307616" msgid="4940454" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">You have my 5 !<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;tid=4940454" title="View&nbsp;Thread"><b>View the reply to this message</b></a><br /><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/4940454/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4940454" data-ref="3_4940454" class="rating-label" name="RateItem_4940454" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4929710_h0" class="header hover-row root">
<td class="subject-line thread " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4929710xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4929710" parent="0" thread="4929710" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;select=4929710&amp;prof=True&amp;view=Thread#xx4929710xx">Nice article about the concept of a semantic database</a> <a onclick="return forumControl49324533.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Volynsky Alex</span><span class="date">25-Oct-14  11:01</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=478442">Volynsky Alex</a></span></td><td class="date"><span>25-Oct-14  11:01&nbsp;</span></td><td class="count">3&nbsp;</td>
</tr>
</table></td>
</tr><tr id="F4929710_h1" class="content root selected" style="display:none;">
<td class="thread" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="478442" msgid="4929710" votingType="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt="" /></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:" /> <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:" /> <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:" /><br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;tid=4929710" title="View&nbsp;Thread"><b>View the 2 replies to this message</b></a><br /><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Sign In</a>·<wbr><a href="/Messages/4929710/Nice-article-about-the-concept-of-a-semantic-datab.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4929710" data-ref="3_4929710" class="rating-label" name="RateItem_4929710" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr>
<td><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt="" /></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  18:00 &nbsp; &nbsp; Last Update: 8-Aug-17  5:17</span></td><td><a rel="nofollow" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;prof=True&amp;view=Thread">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?fid=1871532&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Tight&amp;prof=True&amp;view=Thread&amp;fr=10" /><span class="nav-link selected">1</span></td>
</tr>
</table></td>
</tr>
</table>
</div><p class="small-text"><img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General" /> General &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News" /> News &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion" /> Suggestion &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question" /> Question &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug" /> Bug &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer" /> Answer &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke" /> Joke &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise" /> Praise &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant" /> Rant &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin" /> Admin &nbsp;&nbsp; </p>
				

			</div>
			
		</td>
		<td width="170px" class="article-wing-right">
			<div id="ctl00_RightSideBar" class="container-article-info">

                <div id="RHSticky" class="container-article-info-sticky">
        			

<div class="article-summary">

    <ul class="prize-list">
<li>Best Database Article of October 2014  (First Prize)</li>
</ul>

    

</div>

				    

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Data-Structures"  data-tags='C#, .NET, database, Web, SQLite, PostgreSQL, RDF, NoSQL, OWL, Graph,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=160x600&c=262391"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Data-Structures&sz=160x600&c=262391"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme#_articleTop">Go to top</a>
                    </div>

				</div>

			</div>
		</td>
		</tr></table>

		
		<div class="theme1-background" style="height:2px" id="stickyStop"></div>

		<div class="extended tiny-text">
			<div class="row">
				<div class="float-left">
					<a id="ctl00_PermaLink" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme">Permalink</a> | 
					<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a> |
					<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a> |
                    <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a> |
					<a id="ctl00_Mobile">Mobile</a>
					<br />
								
					
					Web02 |
					2.8.170803.1 |
					Last Updated 25 Oct 2014								
				</div>

                <div id="ctl00_GoogleTranslate" class="translate float-left"></div>      

				<div class="float-right align-right">
					Article Copyright 2014 by Marc Clifton<br />Everything else
					Copyright &copy; <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2017 <br />
				</div>

				


<div class="page-width">
Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?PageFlow=FixedWidth">fixed</a>
|
<a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/Articles/832959/Semantic-Database-Concept-Architecture-and-Impleme?PageFlow=Fluid">fluid</a>
</div>



			</div>
		</div>
		

		<br clear="all" />
		
			

	</div> 
	</div>
</div>


<img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord=&#39;636377878634232694&#39;;dc_seg=33704410?" style="border-width:0px;height:1px;width:1px;" />



<script type="text/javascript" language="Javascript" src="https://codeproject.global.ssl.fastly.net/script/Articles/JS/article.min.js?dt=2.8.170803.1"></script>
<script type="text/javascript" language="Javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script type="text/javascript" language="Javascript" src="/Script/Membership/JS/MemberProfilePopup.min.js?v=1.4"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
$(document).ready(function () { processCodeBlocks.Initialise('#contentdiv'); });
function googleTranslateElementInit() {  new google.translate.TranslateElement({   pageLanguage: 'en',   layout: google.translate.TranslateElement.InlineLayout.SIMPLE,   autoDisplay: false,   gaTrack: true,   gaId: 'UA-1735123-1'},  'ctl00_GoogleTranslate');}
$(document).ready(function() { anchorAnimate();
$('#RHSticky').sticky($('#stickyStop'));
$('#ctl00_Nav').sticky($('#stickyStop'));
});
$(function ()
                {
                    $('.oauth').click(function () {
                        $this = $(this);
                        href = $this.attr('href');
                        var myWindow = window.open(href, 'popup',
                                    'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
                        myWindow.focus();
                        var timer = setInterval(function () {
                                        if (myWindow.closed) {
                                            clearInterval(timer);
                                            // window.location.reload(); // May do a POST reload, shows a warning
                                            window.location = window.location; // force a GET reload
                                        }
                                    }, 200);
                        return false;
                    });
                });
var retrievalService=function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).bind("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};$(document).ready(function(){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new retrievalService).init()}catch(i){(new retrievalService).init()}};try{t=('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn2.developermedia.com/a.min.js';n.open("GET",t,!0);n.send()}catch(i){(new retrievalService).init()}});
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 if(InitWatermark)InitWatermark('sb_tb', 'Search for articles, questions, tips');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
  sbar.blur(function() {
 if (!oSrchFlt) {sfilter.hide(); sfilter.removeClass('open');}
 srchBoxFoc=false;
 });
  sbar.focus(function() {
 oSrchFlt=false; srchBoxFoc=true;
 sfilter.show(); sfilter.addClass('open');
 });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});
$('#clear-rate_ctl00_RateArticle_RSU').click(function () {    $('#ctl00_RateArticle_RSU').hide(); return false;});$("#ctl00_RateArticle_RateItemWrapper")   .removeClass("container-rating")   .hover( function() { $('#ctl00_RateArticle_RSU').fadeIn('fast'); },            function() { $('#ctl00_RateArticle_RSU').fadeOut('fast'); } );
function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 832959,2,1,true,true,0,'MediumStars', null, ratingAjaxCallback);
}

                        function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                            if (!$('#' + containerId).attr('alreadyRequested')){
                                $.ajax({
                                    url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId,
                                    success: function (data) {
                                        $('#' + containerId).html(data);
                                        $('#' + loadingId).hide();
                                    }
                                });
                                $('#' + containerId).attr('alreadyRequested', 'true');
                            }
                        }
$(document).ready(function() {
  new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
  $('#ctl00_RateArticle_RB').mouseenter(function() {     getVotesHistogram(832959,2   ,'ctl00_RateArticle_Histogram','ctl00_RateArticle_Loading');
  });
})

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(){}

var config49324533 = {
    objectName          : 'forumControl49324533',
    messageTypeId       : 3,
    smoothScroll        : true,
    allowReporting      : false,
    allowRating         : false,
    allowRatingDisplay  : true,
    forumDir            : '/script/Forums/',
    staticServer        : 'https://codeproject.global.ssl.fastly.net',
    switchMsgCallback   : null,
    getVoteFormMethod   : getVoteFormHtml,
    getReportFormMethod : getReportFormHtml,
    voteHiThreshold     : 5 - 0.5,
    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
    getRatingRefKey     : 'obrs',
    reportOptions       : [
       { reportTypeId : 19, name : 'Abusive / Trolling'},
       { reportTypeId : 20, name : 'Inappropriate'},
       { reportTypeId : 5, name : 'Spam'},
    ],
};
var forumControl49324533 = new ForumControl(config49324533, -1);
$(document).ready(function() {
    forumControl49324533.Initialise();
});


//]]>
</script>


</body>
</html>